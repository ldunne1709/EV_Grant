</script>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<script language="javascript" type="text/javascript" src="https://ww3.allnone.ie/library/javascript/jquery/jquery-1.9.1.js"></script>
<script language="javascript" type="text/javascript" src="https://ww3.allnone.ie/library/javascript/jquery/jquery-ui.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="https://ww3.allnone.ie/library/javascript/jquery/jquery-ui.js"></script>
<script language="javascript" type="text/javascript" src="https://ww3.allnone.ie/library/javascript/jquery/jquery-ui.js"></script>
<script language="javascript" type="text/javascript" src="https://ww3.allnone.ie/library/jquery/jqueryUI-TimePicker.js"></script>
<script language="javascript" type="text/javascript" src="https://ww3.allnone.ie/library/jquery/jqueryUI-TimePicker.js"></script>
<script language="javascript" type="text/javascript" src="https://ww3.allnone.ie/library/javascript/fn_javascript_dragndropsort.js"></script>
<script language="javascript" type="text/javascript" src="https://ww3.allnone.ie/library/javascript/fn_javascript_dragndropsort.js"></script>
<script language="javascript" type="text/javascript" src="https://ww3.allnone.ie/library/javascript/fn_javascript_cookies.js"></script>
<script language="javascript" type="text/javascript" src="https://ww3.allnone.ie/library/javascript/fn_javascript_cookies.js"></script>
<script src="https://ww3.allnone.ie/client/client_fexco/custom/moments.js" type="text/javascript" language="javascript"></script>
<script src="https://ww3.allnone.ie/client/client_fexco/custom/moment-business.js" type="text/javascript" language="javascript"></script>
<script src="https://ww3.allnone.ie/client/client_fexco/custom/moment-holiday.js" type="text/javascript" language="javascript"></script>


<script language="javascript" type="text/javascript" src="https://ww3.allnone.ie/client/client_fexco/custom/mbso_validation.js"></script>
<script language="javascript" type="text/javascript" src="https://ww3.allnone.ie/client/client_fexco/custom/mbso_formatting.js"></script>
<link rel="stylesheet" type="text/css" href="https://ww3.allnone.ie/client/client_fexco/custom/SBCIModalBox.css" />
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />

<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script language="javascript" type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<div id="dialog-confirm" title="In this an outbound call?" class="selector">
    <!-- <p><span class="ui-icon ui-icon-alert" style="float:left; margin:12px 12px 20px 0;"></span>Is this an outbound call? Clicking Yes will set the outbound outcomes</p>-->
</div>

<style>
    .cssMaster_Table100PC_SectionHeader {
        width: 100%;
        border: 0px;
        border-spacing: 0;
        border-collapse: collapse;
        margin-top: 20px;
    }

    .Spoken {
        color: #13292f;
        font-weight: bold;
        font-size: 12px;
        border-radius: 20px;
    }

    b,
    strong {
        font-weight: 700;
        color: #1B1B1B;
    }

    .Master_Scripting_Line_Background {
        background-color: #469eb7;
        background: linear-gradient(to right, #336367, #479fb8);
        /* background-color: red; */
        background: linear-gradient(to right, #479fb8, #479fb800);
        /* color: #ffffff; */
        /* padding-top: 30px; */
        cursor: default;
    }


    .Master_Scripting_Line_Background {
        color: #ffffff;
        cursor: default;
    }

    .cssInlineTabs ul {
        padding: 0px;
        margin: 0px;
        margin-left: 10px;
        padding-top: 10px;
        list-style-type: none;
    }


    /*.cssInlineTabs ul li a:active
    {
        text-decoration: none;
        background: #084856;
        font-size: 12px;
        border-radius: 20px;
    }*/

    .cssInlineTabs ul li a:hover {
        text-decoration: none;
        background: #084856;
        font-size: 12px;
        border-radius: 20px;
    }

    .cssInlineTabs ul li a {
        background: transparent;
        position: relative;
        display: block;
        /* margin-left: 6px; */
        line-height: 30px;
        padding-left: 6px;
        padding-right: 6px;
        /* background: #dedede; */
        z-index: 499;
        border: 0px solid #fff;
        border-radius: 20px;

        color: #ffffff;
        text-decoration: none;
        font-weight: bold;
        font-size: 12px;
    }

    #divTabs_strCDA_1326_field_0_23 {
        background-color: #469eb7;
        background: linear-gradient(to right, #336367, #479fb8);
        height: 50px;
        width: 100%;
        border-radius: 2px;
    }

    .no-close .ui-dialog-titlebar-close {
        display: none
    }

    div.ui-dialog.ui-widget.ui-widget-content.ui-corner-all.ui-front.no-close.ui-draggable.ui-dialog-buttons {
        z-index: 1000;
        position: absolute;
        height: auto;
        width: 400px;
        top: 350.009px;
        left: 513.003px;
        display: block;
    }

    table#tableid_228 * input#strCDA_1291_field_0_228{
        font-weight: 600;
        font-size: 20px;
        color: navy;
        border: none;
        margin-left: -300px;    
        width: 120%;    
    }

    
    table#tableid_228 * tr#tableid_228_tr > td#tableid_228_testing_4 > div.Spoken {
        color: #fff;
        margin: 1em;
        font-size: 20px;
    }

    input[type="text"]#strCDA_1291_field_0_228 {
        margin: 1em;
    }

    table#tableid_232 {
        padding: 1em;
    }

    #divLiveSearch * {
        color: #fff!important;
    }

    #divLiveSearch > input[type="button"].Master_Button {
        margin: 1em;
        font-weight: 600;
        min-width: 50px;
    }
    #divLiveSearch2 > input[type="button"].Master_Button {
        margin: 1em;
        font-weight: 600;
        min-width: 50px;
    }

    tr#tableid_228_tr {
        valign: bottom;
        background-color: #fff;
        
    }

    .cssInlineTabs {
        cursor: pointer;
    }






</style>

<script>
    var $JQ = jQuery.noConflict();
    $JQ('tr#tableid_228_tr').removeAttr('valign');




    function MPRNCheck() {

        aryAjax_Settings[0] = 'client_fexco';
        aryAjax_Settings[1] = '';
        aryAjax_Settings[2] = '';
        aryAjax_Settings[3] = '1291';
        aryAjax_Settings[4] = 'strCDA_1291_field_0_14';//mprn
        aryAjax_Settings[5] = document.getElementById('strCDA_1291_field_0_14').value;//mprn
        aryAjax_Settings[13] = -1;
        aryAjax_Settings[14] = 'false';
        aryAjax_Settings[15] = 'divWarning';
        aryAjax_Settings[16] = 'InsertCount';

        aryAjax_Settings[6] = 'intCDA_1291_Id';//form id
        aryAjax_Settings[12] = 'id';
        aryAjax_Settings[17] = 'strCDA_1291_field_0_223';//create a new field


        aryAjax_Settings[22] = document.getElementById('intSystemGenerated_CompanyId').value;
        aryAjax_Settings[23] = document.getElementById('intSystemGenerated_UserId').value;
        aryAjax_Settings[24] = document.getElementById('intSystemGenerated_LoginKey').value;
        aryAjax_Settings[28] = 'checkMprn()'; //if it is one alert mprn yoke


        fn_Ajax_BE_Process();

    };


    function checkMprn() {

        if (document.getElementById('strCDA_1291_field_0_223').value > 1) {

            alert('The MPRN of' + ' ' + document.getElementById('strCDA_1291_field_0_14').value + ' ' + 'has been used in a previous application.Please lookup this MPRN which is assoicated with another record before processing this application');
        }
    }    

    function showStatus() {

        var amber = '#e0d530';
        var green = '#11af1e';
        var red = '#e20909';

        var currentStatus = document.getElementById('strCDA_1291_field_0_228');
        var tableid_228_tr = document.getElementById('tableid_228_tr');
        currentStatus.readOnly = true;
        if (strPreviousStatus.value == '') {
        currentStatus.value = 'No Status available'
        }

        else if (
            strPreviousStatus.value == 'Application Approved' ||
            strPreviousStatus.value == 'Pending Customer' ||
            strPreviousStatus.value == 'Escalation Required' ||  
            strPreviousStatus.value == 'Taxi Qualification Required' || 
            strPreviousStatus.value == 'File Uploaded' || 
            strPreviousStatus.value == 'Email Pending Applicant Bank Mandate' ||
            strPreviousStatus.value == 'Email Resend Payment Form' ||
            strPreviousStatus.value == 'EV HC Payment Input' ||
            strPreviousStatus.value == 'New Application' ||
            strPreviousStatus.value == 'Post Resend Payment Form' ||
            strPreviousStatus.value == 'Post Payment Approved' ||
            strPreviousStatus.value == 'Email Pending Applicant Bank Mandate' ||
            strPreviousStatus.value == 'Safe Electric Qualification Required' ||
            strPreviousStatus.value == 'Safe Electric Daily File Created' ||
            strPreviousStatus.value == 'Safe Electric Qualification Updated' ||
            strPreviousStatus.value == 'Post Pending Applicant Bank Mandate'){
                tableid_228_tr.style.backgroundColor  = amber;
                currentStatus.value = strPreviousStatus.value;
        } 
        else if (
            strPreviousStatus.value == 'Duplicate' || 
            strPreviousStatus.value == 'Homeowner Cancellation' || 
            strPreviousStatus.value == 'Cancellation Rejection' || 
            strPreviousStatus.value == 'Payment Not Authorised - HOD' || 
            strPreviousStatus.value == 'Payment Not Authorised - Program Manger' || 
            strPreviousStatus.value == 'Application Declined' || 
            strPreviousStatus.value == 'Application Rejected' ||             
            strPreviousStatus.value == 'Email Payment Declined' || 
            strPreviousStatus.value == 'Email Payment Rejection - Pending Documentation' || 
            strPreviousStatus.value == 'Homeowner Contact Cancellation' || 
            strPreviousStatus.value == 'Homeowner Web Cancellation' || 
            strPreviousStatus.value == 'Post Payment Declined' || 
            strPreviousStatus.value == 'Expired' || 
            strPreviousStatus.value == 'Post Payment Rejection - Pending Documentation'){
                tableid_228_tr.style.backgroundColor  = red;
                currentStatus.value = strPreviousStatus.value;
        }

        else if (
            strPreviousStatus.value == 'Ready for Payment' ||
            strPreviousStatus.value == 'Authorized to Pay' ||
            strPreviousStatus.value == 'Approved to Pay - Programme Manager' ||
            strPreviousStatus.value == 'Approved to Pay - HOD' ||
            strPreviousStatus.value == 'Represent - Ready for Payment' ||
            strPreviousStatus.value == 'Safe Electric Qualification Approved' ||
            strPreviousStatus.value == 'Payment Complete' ){
                tableid_228_tr.style.backgroundColor  = green;
                currentStatus.value = strPreviousStatus.value;

            } 
        
        else {
            currentStatus.value = strPreviousStatus.value;
        }
    }

    showStatus();  

    ///hide Callback etc fields at bottom of form
    document.getElementById('tableBE_Callback').style.display = 'none'; //Hides the call back
    document.getElementById('tableBE_AssignTask').style.display = 'none'; //Hides the assign task
    document.getElementById('tableBE_ViewAppointments').style.display = 'none'; //Hides the view appointments
    document.getElementById('tableBE_AppointmentFrom').style.display = 'none'; //Hides the appointment from
    document.getElementById('tableBE_AppointmentTo').style.display = 'none'; //Hides the appointment to
    var BIC_test = document.getElementById('strCDA_1291_field_0_76');
    var BIC = document.getElementById('strCDA_1291_field_0_76');
    var FirstName = document.getElementById('strCDA_1291_field_0_2');
    var LastName = document.getElementById('strCDA_1291_field_0_3');
    var TaxiApplicant_Decline = document.getElementById('strCDA_1291_field_0_172');
    var Applicant_Decline = document.getElementById('strCDA_1291_field_0_170');
    var VehRegDecline = document.getElementById('strCDA_1291_field_0_176');
    var Cert3Decline = document.getElementById('strCDA_1291_field_0_178');
    var TestRecordSheetDecline = document.getElementById('strCDA_1291_field_0_179');
    var EvDecline = document.getElementById('strCDA_1291_field_0_196');
    var EvChargeDecline = document.getElementById('strCDA_1291_field_0_197');


    var PaymentRequestForm_Rejection = document.getElementById('strCDA_1291_field_0_115');
    var TaxiApplicants_Rejection = document.getElementById('strCDA_1291_field_0_162');
    var SupportDoc_Rejection = document.getElementById('strCDA_1291_field_0_161');
    var REC_Rejection = document.getElementById('strCDA_1291_field_0_163');
    var RecordSheet_Rejection = document.getElementById('strCDA_1291_field_0_164');
    var EvChargerPoint_Rejection = document.getElementById('strCDA_1291_field_0_165');
    var VehicleRegCheck_Rejection = document.getElementById('strCDA_1291_field_0_166');
    var Certificate3_Rejection = document.getElementById('strCDA_1291_field_0_167');

    var UppercaseAddress = document.getElementById('strCDA_1291_field_0_4').value;
    var UppercaseAdrressField = document.getElementById('strCDA_1291_field_0_4');

    var UppercaseAddress1 = document.getElementById('strCDA_1291_field_0_5').value;
    var UppercaseAdrressField1 = document.getElementById('strCDA_1291_field_0_5');

    var UppercaseAddress2 = document.getElementById('strCDA_1291_field_0_6').value;
    var UppercaseAdrressField2 = document.getElementById('strCDA_1291_field_0_6');

    var UppercaseSurnameValue = document.getElementById('strCDA_1291_field_0_3').value;
    var UppercaseSurname = document.getElementById('strCDA_1291_field_0_3');

    var UppercaseSurnameValue2 = document.getElementById('strCDA_1291_field_0_3').value;
    var UppercaseSurname2 = document.getElementById('strCDA_1291_field_0_3');

    var BankaccountName = document.getElementById('strCDA_1291_field_0_74');
    var BankAccountValue = document.getElementById('strCDA_1291_field_0_74').value;
    var bxpFormOutcome = document.getElementById('strContact_Outcome');

    var outwardChannel = document.getElementsByName('strCDA_1291_field_0_189');
    var outwardChannelPost = outwardChannel[1];
    var outwardChannelEmail = outwardChannel[0];
    var outwardChannelSafe = outwardChannel[2];
    var outwardChannelTaxi = outwardChannel[3];


    //SetFields To Not Visbible
    document.getElementById("tableid_210").style.display = 'none';
    document.getElementById("tableid_211").style.display = 'none';
    document.getElementById("tableid_212").style.display = 'none';
    document.getElementById("tableid_213").style.display = 'none';
    document.getElementById("tableid_214").style.display = 'none';
    document.getElementById("tableid_215").style.display = 'none';
    document.getElementById("tableid_216").style.display = 'none';
    document.getElementById("tableid_217").style.display = 'none';
    document.getElementById("tableid_218").style.display = 'none';

    document.getElementById('tableid_113').style.display = 'none';
    document.getElementById('tableid_169').style.display = 'none';
    document.getElementById('tableid_135').style.display = 'none';
    document.getElementById('tableid_139').style.display = 'none';
    document.getElementById('tableid_171').style.display = 'none';
    document.getElementById('tableid_152').style.display = 'none';
    document.getElementById('tableid_153').style.display = 'none';
    document.getElementById('tableid_154').style.display = 'none';
    document.getElementById('tableid_155').style.display = 'none';
    document.getElementById('tableid_156').style.display = 'none';
    document.getElementById('tableid_173').style.display = 'none';
    document.getElementById('tableid_175').style.display = 'none';


    function fn_RangeDisplayChange(intStartPos, intEndPos, strStyleToApply) {
        for (var i = intStartPos; i < (intEndPos + 1); i++) {
            if (document.getElementById(('tableid_' + i))) {
                document.getElementById(('tableid_' + i)).style.display = strStyleToApply;
            }
        }
    }
    var liTab_strCDA_1291_field_0_125_tableid_87 = document.getElementById('liTab_strCDA_1291_field_0_125_tableid_87');

    var liTab_strCDA_1291_field_0_125_tableid_126 = document.getElementById('liTab_strCDA_1291_field_0_125_tableid_126');
    var liTab_strCDA_1291_field_0_125_tableid_108 = document.getElementById('liTab_strCDA_1291_field_0_125_tableid_108');
    var liTab_strCDA_1291_field_0_125_tableid_73 = document.getElementById('liTab_strCDA_1291_field_0_125_tableid_73');

    function TaxiLogic() {
        // * Hide all form question on the page
        fn_RangeDisplayChange(0, 300, 'none');

        document.getElementById('tableid_186').style.display = 'inline';
        document.getElementById('tableid_125').style.display = 'inline';
        document.getElementById('tableid_126').style.display = 'inline';
        document.getElementById('tableid_57').style.display = 'inline';
        document.getElementById('tableid_58').style.display = 'inline';
        document.getElementById('tableid_59').style.display = 'inline';
        document.getElementById('tableid_136').style.display = 'inline';
        document.getElementById('tableid_157').style.display = 'inline';
        document.getElementById('tableid_189').style.display = 'inline';
        TaxisDocumentPaymentRequest();
    }

    function PaymentLogic() {
        // * Hide all form question on the page
        fn_RangeDisplayChange(0, 300, 'none');

        document.getElementById('tableid_186').style.display = 'inline';
        document.getElementById('tableid_125').style.display = 'inline';
        document.getElementById('tableid_73').style.display = 'inline';
        document.getElementById('tableid_74').style.display = 'inline';
        document.getElementById('tableid_75').style.display = 'inline';
        document.getElementById('tableid_76').style.display = 'inline';
        document.getElementById('tableid_77').style.display = 'inline';
        document.getElementById('tableid_78').style.display = 'inline';
        document.getElementById('tableid_130').style.display = 'inline';
        document.getElementById('tableid_168').style.display = 'inline';
        document.getElementById('tableid_134').style.display = 'inline';
        document.getElementById('tableid_189').style.display = 'inline';
        document.getElementById('tableid_227').style.display = 'inline';
        ApplicationsDocumentPaymentRequest();
        ApplicationsSupportingDocument();
    }

    function VehRegCheckLogic() {
        // * Hide all form question on the page
        fn_RangeDisplayChange(0, 300, 'none');
        document.getElementById('tableid_125').style.display = 'inline';
        document.getElementById('tableid_109').style.display = 'inline';
        document.getElementById('tableid_108').style.display = 'inline';
        document.getElementById('tableid_110').style.display = 'inline';
        document.getElementById('tableid_160').style.display = 'inline';
        document.getElementById('tableid_189').style.display = 'inline';
        document.getElementById('tableid_186').style.display = 'inline';
        VehRegCheck();


    }

    function DocumentationLogic() {
        // * Hide all form question on the page
        fn_RangeDisplayChange(0, 300, 'none');

        document.getElementById('tableid_125').style.display = 'inline';


        document.getElementById('tableid_69').style.display = 'inline';
        document.getElementById('tableid_70').style.display = 'inline';
        document.getElementById('tableid_89').style.display = 'none';
        document.getElementById('tableid_90').style.display = 'inline';
        document.getElementById('tableid_91').style.display = 'inline';
        document.getElementById('tableid_119').style.display = 'inline';
        document.getElementById('tableid_117').style.display = 'inline';
        document.getElementById('tableid_116').style.display = 'inline';


        document.getElementById('tableid_118').style.display = 'inline';
        document.getElementById('tableid_120').style.display = 'inline';
        document.getElementById('tableid_121').style.display = 'inline';
        document.getElementById('tableid_122').style.display = 'inline';
        document.getElementById('tableid_123').style.display = 'inline';
        document.getElementById('tableid_101').style.display = 'inline';
        document.getElementById('tableid_102').style.display = 'inline';
        document.getElementById('tableid_103').style.display = 'inline';

        document.getElementById('tableid_104').style.display = 'inline';
        document.getElementById('tableid_93').style.display = 'inline';
        document.getElementById('tableid_94').style.display = 'inline';
        document.getElementById('tableid_105').style.display = 'inline';
        document.getElementById('tableid_106').style.display = 'inline';
        document.getElementById('tableid_187').style.display = 'inline';
        document.getElementById('tableid_107').style.display = 'inline';
        document.getElementById('tableid_95').style.display = 'inline';

        document.getElementById('tableid_96').style.display = 'inline';
        document.getElementById('tableid_97').style.display = 'inline';
        document.getElementById('tableid_98').style.display = 'inline';
        document.getElementById('tableid_99').style.display = 'inline';
        document.getElementById('tableid_100').style.display = 'inline';
        document.getElementById('tableid_186').style.display = 'inline';
        document.getElementById('tableid_87').style.display = 'inline';
        document.getElementById('tableid_151').style.display = 'inline';

        document.getElementById('tableid_140').style.display = 'inline';
        document.getElementById('tableid_142').style.display = 'inline';
        document.getElementById('tableid_144').style.display = 'inline';
        document.getElementById('tableid_146').style.display = 'inline';
        document.getElementById('tableid_148').style.display = 'inline';
        document.getElementById('tableid_189').style.display = 'inline';
        document.getElementById('tableid_152').style.display = 'none';
        document.getElementById('tableid_153').style.display = 'none';
        document.getElementById('tableid_173').style.display = 'none';
        document.getElementById('tableid_154').style.display = 'none';

        document.getElementById('tableid_177').style.display = 'none';
        document.getElementById('tableid_155').style.display = 'none';
        document.getElementById('tableid_157').style.display = 'none';
        document.getElementById('tableid_156').style.display = 'none';
        document.getElementById('tableid_175').style.display = 'none';
        document.getElementById('tableid_209').style.display = 'inline';

        document.getElementById('tableid_79').style.display = 'inline';
        document.getElementById('tableid_80').style.display = 'inline';
        document.getElementById('tableid_119').style.display = 'inline';
        document.getElementById('tableid_117').style.display = 'inline';
        document.getElementById('tableid_118').style.display = 'inline';
        document.getElementById('tableid_120').style.display = 'inline';
        document.getElementById('tableid_121').style.display = 'inline';
        document.getElementById('tableid_122').style.display = 'inline';
        document.getElementById('tableid_123').style.display = 'inline';
        document.getElementById('tableid_220').style.display = 'none';

        ElecCert3();
        ElecTestRecordSheet();
        RECAcceptRaject();
        PaymentFormSignatureReject();


    }
    function TodaysDate() {



        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth() + 1; //January is 0!
        var yyyy = today.getFullYear();
        if (dd < 10) {
            dd = '0' + dd
        }

        if (mm < 10) {
            mm = '0' + mm
        }

        today = dd + '/' + mm + '/' + yyyy;
        document.getElementById('strCDA_1291_field_0_194').value = today;
    }
    function Ev_Charge_Point_Decline() {

        if (document.getElementById('strCDA_1291_field_0_103').value = 'Yes') {


        }


    }

      function ApplicationsDocumentPaymentRequest() {

        if (document.getElementById('strCDA_1291_field_0_168').value == 'Reject') {

            document.getElementById('tableid_169').style.display = 'none';
            document.getElementById('tableid_113').style.display = 'inline';


        }
        else if (document.getElementById('strCDA_1291_field_0_168').value == 'Decline') {

            document.getElementById('tableid_169').style.display = 'inline';
            document.getElementById('tableid_113').style.display = 'none';

        }

        else if (document.getElementById('strCDA_1291_field_0_168').value == 'Accept') {

            document.getElementById('tableid_169').style.display = 'none';
            document.getElementById('tableid_113').style.display = 'none';

        }
        else if (document.getElementById('strCDA_1291_field_0_168').value == '') {

            document.getElementById('tableid_169').style.display = 'none';
            document.getElementById('tableid_113').style.display = 'none';

        }
    }

    function TaxisDocumentPaymentRequest() {

        if (document.getElementById('strCDA_1291_field_0_157').value == 'Reject') {

            document.getElementById('tableid_171').style.display = 'none';
            document.getElementById('tableid_139').style.display = 'inline';

        }
        else if (document.getElementById('strCDA_1291_field_0_157').value == 'Decline') {

            document.getElementById('tableid_171').style.display = 'inline';
            document.getElementById('tableid_139').style.display = 'none';

        }

        else if (document.getElementById('strCDA_1291_field_0_157').value == 'Accept') {

            document.getElementById('tableid_171').style.display = 'none';
            document.getElementById('tableid_139').style.display = 'none';

        }

        else if (document.getElementById('strCDA_1291_field_0_157').value == '') {

            document.getElementById('tableid_171').style.display = 'none';
            document.getElementById('tableid_139').style.display = 'none';

        }
    }

    function PaymentFormSignatureReject() {

        if (document.getElementById('strCDA_1291_field_0_151').value == 'Reject') {


            document.getElementById('tableid_220').style.display = 'inline';

        }


        else if (document.getElementById('strCDA_1291_field_0_151').value == 'Accept') {


            document.getElementById('tableid_220').style.display = 'none';

        }
        else if (document.getElementById('strCDA_1291_field_0_151').value == '') {


            document.getElementById('tableid_220').style.display = 'none';

        }
    }



    function ElecCert3() {

        if (document.getElementById('strCDA_1291_field_0_144').value == 'Reject') {

            document.getElementById('tableid_173').style.display = 'none';
            document.getElementById('tableid_153').style.display = 'inline';

        }
        else if (document.getElementById('strCDA_1291_field_0_144').value == 'Decline') {

            document.getElementById('tableid_153').style.display = 'none';
            document.getElementById('tableid_173').style.display = 'inline';

        }

        else if (document.getElementById('strCDA_1291_field_0_144').value == 'Accept') {

            document.getElementById('tableid_153').style.display = 'none';
            document.getElementById('tableid_173').style.display = 'none';

        }
        else if (document.getElementById('strCDA_1291_field_0_144').value == '') {

            document.getElementById('tableid_153').style.display = 'none';
            document.getElementById('tableid_173').style.display = 'none';

        }
    }

    function ElecTestRecordSheet() {

        if (document.getElementById('strCDA_1291_field_0_146').value == 'Reject') {

            document.getElementById('tableid_177').style.display = 'none';
            document.getElementById('tableid_154').style.display = 'inline';

        }
        else if (document.getElementById('strCDA_1291_field_0_146').value == 'Decline') {

            document.getElementById('tableid_154').style.display = 'none';
            document.getElementById('tableid_177').style.display = 'inline';

        }

        else if (document.getElementById('strCDA_1291_field_0_146').value == 'Accept') {

            document.getElementById('tableid_154').style.display = 'none';
            document.getElementById('tableid_177').style.display = 'none';

        }
        else if (document.getElementById('strCDA_1291_field_0_146').value == '') {

            document.getElementById('tableid_154').style.display = 'none';
            document.getElementById('tableid_177').style.display = 'none';

        }
    }

    function ApplicationsSupportingDocument() {

        if (document.getElementById('strCDA_1291_field_0_134').value == 'Reject') {

            document.getElementById('tableid_135').style.display = 'inline';

        }
        else if (document.getElementById('strCDA_1291_field_0_134').value == 'Accept') {


            document.getElementById('tableid_135').style.display = 'none';

        }
        else if (document.getElementById('strCDA_1291_field_0_134').value == '') {


            document.getElementById('tableid_135').style.display = 'none';

        }
    }

    function RECAcceptRaject() {

        if (document.getElementById('strCDA_1291_field_0_142').value == 'Reject') {

            document.getElementById('tableid_152').style.display = 'inline';
        }
        else if (document.getElementById('strCDA_1291_field_0_142').value == 'Accept') {


            document.getElementById('tableid_152').style.display = 'none';

        }
        else if (document.getElementById('strCDA_1291_field_0_142').value == '') {


            document.getElementById('tableid_152').style.display = 'none';

        }
    }

    function EvChargerAcceptOrReject() {

        if (document.getElementById('strCDA_1291_field_0_148').value == 'Reject') {

            document.getElementById('tableid_155').style.display = 'inline';
        }
        else if (document.getElementById('strCDA_1291_field_0_148').value == 'Accept') {


            document.getElementById('tableid_155').style.display = 'none';

        }
        else if (document.getElementById('strCDA_1291_field_0_148').value == '') {


            document.getElementById('tableid_155').style.display = 'none';

        }
    }

    function VehRegCheck() {


        if (document.getElementById('strCDA_1291_field_0_160').value == 'Reject') {

            document.getElementById('tableid_156').style.display = 'inline';
            document.getElementById('tableid_175').style.display = 'none';

        }
        else if (document.getElementById('strCDA_1291_field_0_160').value == 'Decline') {

            document.getElementById('tableid_156').style.display = 'none';
            document.getElementById('tableid_175').style.display = 'inline';

        }

        else if (document.getElementById('strCDA_1291_field_0_160').value == 'Accept') {

            document.getElementById('tableid_156').style.display = 'none';
            document.getElementById('tableid_175').style.display = 'none';

        }
        else if (document.getElementById('strCDA_1291_field_0_160').value == '') {

            document.getElementById('tableid_156').style.display = 'none';
            document.getElementById('tableid_175').style.display = 'none';

        }
    }

    function modifyPaymentCompleteStatus() {
        if (document.getElementById('intSystemGenerated_Client_Role').value == "3") {
            if (document.getElementById('strPreviousStatus').value == "Payment Complete") {
                ReadonlyFields();
                fn_BE_BlankOutcomes();
                fn_BE_AddOutcome('', '');
                fn_BE_AddOutcome('Save Record', 'Save Record');

            }
        }
    }
    function modifyOutcomes2() {
        if (document.getElementById('intSystemGenerated_UserId').value == 97 || document.getElementById('intSystemGenerated_UserId').value == 1053 || document.getElementById('intSystemGenerated_UserId').value == 1433 || document.getElementById('intSystemGenerated_UserId').value == 1498) {
            fn_BE_BlankOutcomes();
            fn_BE_AddOutcome('', '');
            fn_BE_AddOutcome('Application Approved', 'Application Approved');
            fn_BE_AddOutcome('Application Declined', 'Application Declined');
            fn_BE_AddOutcome('Application Rejected', 'Application Rejected');
            fn_BE_AddOutcome('Duplicate', 'Duplicate');
            fn_BE_AddOutcome('Email Payment Declined', 'Email Payment Declined');
            fn_BE_AddOutcome('Email Payment Rejection - Pending Documentation', 'Email Payment Rejection - Pending Documentation');
            fn_BE_AddOutcome('Email Pending Applicant Bank Mandate', 'Email Pending Applicant Bank Mandate');
            fn_BE_AddOutcome('Email Resend Payment Form', 'Email Resend Payment Form');
            fn_BE_AddOutcome('EV HC Payment Input', 'EV HC Payment Input');
            fn_BE_AddOutcome('Escalation Required', 'Escalation Required');
            fn_BE_AddOutcome('Homeowner Contact Cancellation', 'Homeowner Contact Cancellation');
            fn_BE_AddOutcome('Homeowner Web Cancellation', 'Homeowner Web Cancellation');
            fn_BE_AddOutcome('New Application', 'New Application');
            fn_BE_AddOutcome('Post Payment Declined', 'Post Payment Declined');
            fn_BE_AddOutcome('Post Payment Rejection - Pending Documentation', 'Post Payment Rejection - Pending Documentation');
            fn_BE_AddOutcome('Post Pending Applicant Bank Mandate', 'Post Pending Applicant Bank Mandate');
            fn_BE_AddOutcome('Post Resend Payment Form', 'Post Resend Payment Form');
            fn_BE_AddOutcome('Ready for Payment', 'Ready for Payment');
            fn_BE_AddOutcome('Represent - Ready for Payment', 'Represent - Ready for Payment');
            fn_BE_AddOutcome('Safe Electric Qualification Required', 'Safe Electric Qualification Required');
            fn_BE_AddOutcome('Safe Electric Qualification Updated', 'Safe Electric Qualification Updated');
            fn_BE_AddOutcome('Safe Electric Qualification Approved', 'Safe Electric Qualification Approved');
            fn_BE_AddOutcome('Save Record', 'Save Record');
            fn_BE_AddOutcome('Taxi Qualification Required', 'Taxi Qualification Required');
        }
    }


    function fn_ModifyOutcomes() {


        if (document.getElementById('intSystemGenerated_Client_Role').value == 2 || document.getElementById('intSystemGenerated_Client_Role').value == 3 || document.getElementById('intSystemGenerated_UserId').value == 144) {
            fn_BE_BlankOutcomes();
            fn_BE_AddOutcome('', '');
            fn_BE_AddOutcome('Application Approved', 'Application Approved');
            fn_BE_AddOutcome('Application Declined', 'Application Declined');
            fn_BE_AddOutcome('Application Rejected', 'Application Rejected');
            fn_BE_AddOutcome('Duplicate', 'Duplicate');
            fn_BE_AddOutcome('Email Payment Declined', 'Email Payment Declined');
            fn_BE_AddOutcome('Email Payment Rejection - Pending Documentation', 'Email Payment Rejection - Pending Documentation');
            fn_BE_AddOutcome('Email Pending Applicant Bank Mandate', 'Email Pending Applicant Bank Mandate');
            fn_BE_AddOutcome('Email Resend Payment Form', 'Email Resend Payment Form');
            fn_BE_AddOutcome('EV HC Payment Input', 'EV HC Payment Input');
            fn_BE_AddOutcome('Escalation Required', 'Escalation Required');
            fn_BE_AddOutcome('Homeowner Contact Cancellation', 'Homeowner Contact Cancellation');
            fn_BE_AddOutcome('Homeowner Web Cancellation', 'Homeowner Web Cancellation');
            fn_BE_AddOutcome('New Application', 'New Application');
            fn_BE_AddOutcome('Post Payment Declined', 'Post Payment Declined');
            fn_BE_AddOutcome('Post Payment Rejection - Pending Documentation', 'Post Payment Rejection - Pending Documentation');
            fn_BE_AddOutcome('Post Pending Applicant Bank Mandate', 'Post Pending Applicant Bank Mandate');
            fn_BE_AddOutcome('Post Resend Payment Form', 'Post Resend Payment Form');
            fn_BE_AddOutcome('Ready for Payment', 'Ready for Payment');
            fn_BE_AddOutcome('Represent - Ready for Payment', 'Represent - Ready for Payment');
            fn_BE_AddOutcome('Save Record', 'Save Record');
            fn_BE_AddOutcome('Safe Electric Qualification Required', 'Safe Electric Qualification Required');
            fn_BE_AddOutcome('Safe Electric Qualification Updated', 'Safe Electric Qualification Updated');
            fn_BE_AddOutcome('Taxi Qualification Required', 'Taxi Qualification Required');
        }

        else if (document.getElementById('intSystemGenerated_UserId').value == 1400) {
            fn_BE_BlankOutcomes();
            fn_BE_AddOutcome('', '');
            fn_BE_AddOutcome('Payment Not Authorised - Program Manger', 'Payment Not Authorised - Program Manger');
            fn_BE_AddOutcome('Represent - Ready for Payment', 'Represent - Ready for Payment');
            fn_BE_AddOutcome('Save Record', 'Save Record');


            ReadonlyFields();



        }

        else if (document.getElementById('intSystemGenerated_UserId').value == 1393) {
            fn_BE_BlankOutcomes();
            fn_BE_AddOutcome('', '');
            fn_BE_AddOutcome('Payment Not Authorised - HOD', 'Payment Not Authorised - HOD');
            fn_BE_AddOutcome('Represent - Ready for Payment', 'Represent - Ready for Payment');
            fn_BE_AddOutcome('Save Record', 'Save Record');
            ReadonlyFields();

        }

        else {


        }


    }



    function CustomersName() {


        var TitleName = document.getElementById('strCDA_1291_field_0_1').value;
        var Firstname = document.getElementById('strCDA_1291_field_0_2').value;
        var Surname = document.getElementById('strCDA_1291_field_0_3').value;

        var FullName = document.getElementById('strCDA_1291_field_0_185');

        FullName.value = TitleName + '' + Firstname + '' + Surname;
    }

    function titleCase(str) {
        str = str.toLowerCase().split(' ');
        for (var i = 0; i < str.length; i++) {


            str[i] = str[i].charAt(0).toUpperCase() + str[i].slice(1);


        }
        return str.join(' ');
    }




    $JQ(document).ready(function () {


        UppercaseAdrressField.value = titleCase(UppercaseAddress);
        UppercaseAdrressField1.value = titleCase(UppercaseAddress1);
        UppercaseAdrressField2.value = titleCase(UppercaseAddress2);
        if (UppercaseSurname.value.indexOf("'") == -1) {
            UppercaseSurname.value = titleCase(UppercaseSurnameValue);
            console.log('a');
        }
        else {
            document.getElementById('strCDA_1291_field_0_3').value = document.getElementById('strCDA_1291_field_0_3').value.replace(/'[a-z]/g, function (letter) { return letter.toUpperCase(); });
            console.log('b');
        }

        BankaccountName.value = titleCase(BankAccountValue);




    });



    document.getElementById('strCDA_1291_field_0_60').value = document.getElementById('strCDA_1291_field_0_14').value.charAt(1);
    document.getElementById('strCDA_1291_field_0_61').value = document.getElementById('strCDA_1291_field_0_14').value.charAt(2);
    document.getElementById('strCDA_1291_field_0_62').value = document.getElementById('strCDA_1291_field_0_14').value.charAt(3);
    document.getElementById('strCDA_1291_field_0_63').value = document.getElementById('strCDA_1291_field_0_14').value.charAt(4);
    document.getElementById('strCDA_1291_field_0_64').value = document.getElementById('strCDA_1291_field_0_14').value.charAt(5);
    document.getElementById('strCDA_1291_field_0_65').value = document.getElementById('strCDA_1291_field_0_14').value.charAt(6);
    document.getElementById('strCDA_1291_field_0_66').value = document.getElementById('strCDA_1291_field_0_14').value.charAt(7);
    document.getElementById('strCDA_1291_field_0_67').value = document.getElementById('strCDA_1291_field_0_14').value.charAt(8);
    document.getElementById('strCDA_1291_field_0_68').value = document.getElementById('strCDA_1291_field_0_14').value.charAt(9);




    /**********************************************
      Application: These functions combine to validate teh IBAN and BIC
  **********************************************/
    var countryAndSize =
    {
        GB: { size: 22, name: 'UK', regex: /[A-Z]{4}d{14}/ },
        IE: { size: 22, name: 'IRELAND', regex: /[A-Z]{4}d{14}/ }
    };

    function fn_Reset_Payment_Fields() {
        document.getElementById('strCDA_1291_field_0_180').value = '';
        document.getElementById('strCDA_1291_field_0_183').value = '';
        document.getElementById('strCDA_1291_field_0_193').value = '';
    }
    var countryAndSize =
    {
        GB : { size: 22, name:'UK', regex:/[A-Z]{4}d{14}/ },
        IE : { size: 22, name:'IRELAND',  regex:/[A-Z]{4}d{14}/}
    };

   var ibanLen = { 
					NO:15, BE:16, DK:18, FI:18, FO:18, GL:18, NL:18, MK:19,
					SI:19, AT:20, BA:20, EE:20, KZ:20, LT:20, LU:20, CR:21,
					CH:21, HR:21, LI:21, LV:21, BG:22, BH:22, DE:22, GB:22,
					GE:22, IE:22, ME:22, RS:22, AE:23, GI:23, IL:23, AD:24,
					CZ:24, ES:24, MD:24, PK:24, RO:24, SA:24, SE:24, SK:24,
					VG:24, TN:24, PT:25, IS:26, TR:26, FR:27, GR:27, IT:27,
					MC:27, MR:27, SM:27, AL:28, AZ:28, CY:28, DO:28, GT:28,
					HU:28, LB:28, PL:28, BR:29, PS:29, KW:30, MU:30, MT:31
				}
				 
				function isValid(iban) {
					iban = iban.replace(/s/g, '')
					if (!iban.match(/^[dA-Z]+$/)) return false
					var len = iban.length
					if (len != ibanLen[iban.substr(0,2)]) return false
					iban = iban.substr(4) + iban.substr(0,4)
					for (var s='', i=0; i<len; i+=1) s+=parseInt(iban.charAt(i),36)
					for (var m=s.substr(0,15)%97, s=s.substr(15); s; s=s.substr(13)) m=(m+s.substr(0,13))%97
					return m == 1
				}

    function AlertValidIban() {

        var IBAN = document.getElementById('strCDA_1291_field_0_75').value;
        if (isValid(IBAN) == true) {

            alert('Valid IBAN');
        } else {
            alert('Not a valid IBAN - Please retry');
        }
    }

    function AgentOutcomesPhase1() {

        fn_BE_BlankOutcomes();
        fn_BE_AddOutcome('', '');
        fn_BE_AddOutcome('Application Approved', 'Application Approved');
        fn_BE_AddOutcome('Application Declined', 'Application Declined');
        fn_BE_AddOutcome('Application Rejected', 'Application Rejected');
        fn_BE_AddOutcome('Duplicate', 'Duplicate');
        fn_BE_AddOutcome('Homeowner Contact Cancellation', 'Homeowner Contact Cancellation');
        fn_BE_AddOutcome('Homeowner Web Cancellation', 'Homeowner Web Cancellation');
        fn_BE_AddOutcome('New Application', 'New Application');
        fn_BE_AddOutcome('Pending Customer', 'Pending Customer');
        fn_BE_AddOutcome('Save Record', 'Save Record');


    }

    function valBic() {

        var regSWIFT = /^([a-zA-Z]){4}([a-zA-Z]){2}([0-9a-zA-Z]){2}([0-9a-zA-Z]{3})?$/;

        if (regSWIFT.test(strCDA_1291_field_0_76.value) == false) {
            alert("SWIFT/BIC Code is not yet valid.");

        }
        else {
            alert("You have entered a valid SWIFT/BIC Code!");

        }
    }
    /*function AuotpopulateBic() {
     var IbanValue = document.getElementById('strCDA_1291_field_0_75').value;
     var BicValue = IbanValue.substr(8,6);
     document.getElementById("strCDA_1291_field_0_76").value = BicValue;
 }*/
           
/*--------------------------------------
// The LiveSearch Lookup settings	
--------------------------------------*/
function fn_LiveSearchMPRN_Database() {
	if (typeof aryAjax_Settings=="undefined")
		alert("Library did not load");
	else {
		//var strValue = document.getElementById('strLiveSearchText').value;
		var divLiveSearch = document.getElementById('divLiveSearch');
		
			aryAjax_Settings[0] = "client_fexco"; 							//Your system name
			aryAjax_Settings[1] = ""; 								//The CMI API Username
			aryAjax_Settings[2] = ""; 								//The CMI API User password

			aryAjax_Settings[3] = "1281"; 								//The Id of the campaign
			aryAjax_Settings[4] = "strCDA_1281_field_0_1"; 						//The search field
			aryAjax_Settings[5] = document.getElementById('strCDA_1291_field_0_14').value;							//The search value
			
			aryAjax_Settings[13] = "-1";								//Id of the current record, used for delimiting and not repeating current case
			aryAjax_Settings[14] = "false";								//Click through to campaign?
			aryAjax_Settings[15] = "divLiveSearch";							//The id of the destination to which the matching links will be inserted
			aryAjax_Settings[16] = "LiveSearch";							//The types of processing.

            aryAjax_Settings[6] = 'intCDA_1281_Id,strCDA_1281_field_0_2,strCDA_1281_field_0_0,strCDA_1281_field_0_11';                                  //The field in the other campaign to be returned order = value, text
            aryAjax_Settings[12] = 'ID,Customer_Name,AppID,status';                                             //Headings for xml troubleshooting
            aryAjax_Settings[17] = 'strCDA_1291_field_0_233,strCDA_1291_field_0_25,strCDA_1291_field_0_228,strCDA_1291_field_0_229';                                 //The field in the current campaign into which the products will be inserted.

			//Use my login to allow me to search
			aryAjax_Settings[22] = document.getElementById('intSystemGenerated_CompanyId').value; 	//Auto Login - System
			aryAjax_Settings[23] = document.getElementById('intSystemGenerated_UserId').value; 	//Auto Login - User
			aryAjax_Settings[24] = document.getElementById('intSystemGenerated_LoginKey').value; 	//Auto Login - SessionId

			//LiveSearch fields
			aryAjax_Settings[25] = "";						    //Field to get Id when button clicked
			aryAjax_Settings[26] = "";							                    //Function to be performed after update	
			aryAjax_Settings[27] = "";				//Field to get Description when button clicked
            aryAjax_Settings[28]    = 'fn_LiveSearchCancellation_Database();';

			fn_Ajax_BE_Process();
		
	}
}

function openInNewTab(value) {
        var win = window.open('https://ww3.allnone.ie/client/client_fexco/inboundsales/userInbound-details.asp?intCampaign_Id=1281&ID='+value, '_blank');
        win.focus();
    }
    function openInNewTab2(value) {
        var win = window.open('https://ww3.allnone.ie/client/client_fexco/inboundsales/userInbound-details.asp?intCampaign_Id=1297&ID='+value, '_blank');
        win.focus();
    }

    function setClicks() {
        var matchedRecords = document.getElementsByName('mylink');
        Array.from(matchedRecords).forEach(function (element) {
            element.value = element.value.replace(' Â»', '');
            element.removeAttribute("onclick");

            if (!element.nextSibling.textContent.toLowerCase().includes('cancellation')) {
            element.onclick = function () {
                openInNewTab(element.value);
            };
            }

            if (element.nextSibling.textContent.toLowerCase().includes('cancellation')) {
            element.onclick = function () {
                openInNewTab2(element.value);
            };
            }
        });
}



function fn_LiveSearchCancellation_Database() {
	if (typeof aryAjax_Settings=="undefined")
		alert("Library did not load");
	else {
	//	var strValue = document.getElementById('strLiveSearchText').value;
		var divLiveSearch = document.getElementById('divLiveSearch2');
		
			aryAjax_Settings[0] = "client_fexco"; 							//Your system name
			aryAjax_Settings[1] = ""; 								//The CMI API Username
			aryAjax_Settings[2] = ""; 								//The CMI API User password

			aryAjax_Settings[3] = "1297"; 								//The Id of the campaign
			aryAjax_Settings[4] = "strCDA_1297_field_0_3"; 						//The search field
			aryAjax_Settings[5] = document.getElementById('strCDA_1291_field_0_14').value;							//The search value
			
			aryAjax_Settings[13] = "-1";								//Id of the current record, used for delimiting and not repeating current case
			aryAjax_Settings[14] = "false";								//Click through to campaign?
			aryAjax_Settings[15] = "divLiveSearch2";							//The id of the destination to which the matching links will be inserted
			aryAjax_Settings[16] = "LiveSearch";							//The types of processing.

            aryAjax_Settings[6] = 'intCDA_1297_Id,strCDA_1297_field_0_1,strCDA_1297_field_0_2,strCDA_1297_field_0_4,strCDA_1297_Status';                                  //The field in the other campaign to be returned order = value, text
            aryAjax_Settings[12] = 'ID,FirstName,Surname, AppID,status';                                             //Headings for xml troubleshooting
            aryAjax_Settings[17] = 'strCDA_1291_field_0_234,strCDA_1291_field_0_235,strCDA_1291_field_0_236,strCDA_1291_field_0_237,strCDA_1291_field_0_238';                                 //The field in the current campaign into which the products will be inserted.

			//Use my login to allow me to search
			aryAjax_Settings[22] = document.getElementById('intSystemGenerated_CompanyId').value; 	//Auto Login - System
			aryAjax_Settings[23] = document.getElementById('intSystemGenerated_UserId').value; 	//Auto Login - User
			aryAjax_Settings[24] = document.getElementById('intSystemGenerated_LoginKey').value; 	//Auto Login - SessionId

			//LiveSearch fields
			aryAjax_Settings[25] = "";						    //Field to get Id when button clicked
			aryAjax_Settings[26] = "";							                    //Function to be performed after update	
			aryAjax_Settings[27] = "";				//Field to get Description when button clicked
            aryAjax_Settings[28]    = 'setClicks();';

			fn_Ajax_BE_Process();
		
	}
}


    //function to check MPRN Database and if MPRN exists bring back the Customer Name Associated with it
    function fn_InsertFromMPRNTable() {


        aryAjax_Settings[0] = 'client_fexco';                                           //Your system name
        aryAjax_Settings[1] = '';                                                          //The CMI API Username
        aryAjax_Settings[2] = '';                                                          //The CMI API User password
        aryAjax_Settings[3] = '1281';                                                   //The campaign which contains the product list
        aryAjax_Settings[4] = 'strCDA_1281_field_0_1';                                  //The field which contains the limiting / grouping factor
        aryAjax_Settings[5] = document.getElementById('strCDA_1291_field_0_14').value;
        //aryAjax_Settings[5]   = document.getElementById('intSystemGenerated_UserId').value;                                               //The value to limit the responses by, in this case only yes items
        aryAjax_Settings[13] = -1;                                                          //Limit responses -1 do not limit
        aryAjax_Settings[14] = 'false';                                                     //Draw a table
        aryAjax_Settings[15] = 'divWarning';                                                //Where to draw error messages if any
        aryAjax_Settings[16] = 'Insert';                                                 //Engine to use i.e. Populate

        aryAjax_Settings[6] = 'strCDA_1281_field_0_2';                                  //The field in the other campaign to be returned order = value, text
        aryAjax_Settings[12] = 'Customer_Name';                                             //Headings for xml troubleshooting
        aryAjax_Settings[17] = 'strCDA_1291_field_0_25';                                 //The field in the current campaign into which the products will be inserted.

        aryAjax_Settings[22] = document.getElementById('intSystemGenerated_CompanyId').value;       //Auto Login - System
        aryAjax_Settings[23] = document.getElementById('intSystemGenerated_UserId').value;          //Auto Login - User
        aryAjax_Settings[24] = document.getElementById('intSystemGenerated_LoginKey').value;        //Auto Login - SessionId
        aryAjax_Settings[28]    = 'fn_LiveSearchMPRN_Database();';
        fn_Ajax_BE_Process();
        //document.getElementById('strContact_Comments').value=aryAjax_Settings[7]


    }



    //check to ensure MPRN on page
    if (document.getElementById('strCDA_1291_field_0_14').value !== '' && document.getElementById('strCDA_1291_field_0_14').value !== 0) {
        fn_InsertFromMPRNTable();
        //function to pop an alert - set for 1.5 seconds after page loads to give AJAX call time to populate Customer Name with inital AJAX check
        setTimeout(function fn_Create_Alert() {
            if (document.getElementById('strCDA_1291_field_0_25').value.length == '0') {
                alert('This MPRN was not previously paid a grant before, please proceed with next step in Application Checklist');
            }
            else if (document.getElementById('strCDA_1291_field_0_25').value.length > 0) {
                alert('A grant has previously been paid to ' + document.getElementById('strCDA_1291_field_0_25').value + '. Please reject this Application');
            }
        }, 1500);
    }

    /**********************************************
       Application: The below function kicks off the ajax call to update the counter number
    **********************************************/

    //check if Application ID already linked with record

    if (document.getElementById('strCDA_1291_field_0_37').value.length === 0) {
        setTimeout(function fn_FEXCO_GetCurrentMandateNumber() {

            if (typeof aryAjax_Settings == 'undefined') { alert('Library did not load'); }
            else {

                            // Clear all settings
                            fn_Ajax_bxp_ResetSettings();

                // Security Settings
                aryAjax_Settings[0] = 'client_fexco';
                aryAjax_Settings[22] = document.getElementById('intSystemGenerated_CompanyId').value;     //Auto Login - System
                aryAjax_Settings[23] = document.getElementById('intSystemGenerated_UserId').value;        //Auto Login - User
                aryAjax_Settings[24] = document.getElementById('intSystemGenerated_LoginKey').value;         //Auto Login - SessionId

                // Retrieval Settings
                aryAjax_Settings[16] = 'Insert';                                                 //Engine to use
                aryAjax_Settings[3] = 1285;                                                  //The form with the data
                aryAjax_Settings[4] = 'intCDA_1285_Id';                                         //The Id field to match on
                aryAjax_Settings[5] = '1';                                    //The Id of the CDA record with the data
                aryAjax_Settings[13] = '-1'                                                   //Limit response
                aryAjax_Settings[40] = "500";                                              //Retrieval limit if applicable

                //Error management
                aryAjax_Settings[15] = 'divWarning';                                                //Where to draw error messages if any

                //Common Functional settings
                aryAjax_Settings[6] = 'strCDA_1285_field_0_1';                                  //The data fields to retrieve
                aryAjax_Settings[12] = 'strCDA_1285_field_0_1';                                        //Headings for xml troubleshooting
                aryAjax_Settings[17] = 'strCDA_1291_field_0_37';                                    //The fields to insert the data into
                aryAjax_Settings[28] = 'fn_FEXCO_UpdateExistingApplicationNumber();';                        //Function to be executed after retrieval

//Function specific settings
//...

//Execute
fn_Ajax_bxp_Process();                                                           //The main execution of the AJAX

//Write URL out (Comment out after testing)
/*if (document.getElementById('divURL')){
   document.getElementById('divURL').innerHTML = "<a href='" + aryAjax_Settings[7] + "' target='_blank'>Constructed AJAX URL</a>";
}*/

            }
        }, 3000);
    }


    //***********************************************************************
    // Application   : 
    //***********************************************************************
    function fn_FEXCO_UpdateExistingApplicationNumber() {
        if (typeof aryAjax_Settings == 'undefined') { alert('Library did not load'); }
        else {


                    // Clear all settings
                    fn_Ajax_bxp_ResetSettings();

                // Security Settings
                aryAjax_Settings[0] = 'client_fexco';
                aryAjax_Settings[22] = document.getElementById('intSystemGenerated_CompanyId').value;        //Auto Login - System
                aryAjax_Settings[23] = document.getElementById('intSystemGenerated_UserId').value;           //Auto Login - User
                aryAjax_Settings[24] = document.getElementById('intSystemGenerated_LoginKey').value;            //Auto Login - SessionId

                // Retrieval Settings
                aryAjax_Settings[16] = 'dbUpdateRecord';                                               //Engine to use
                aryAjax_Settings[3] = 1285;                                                     //The form to insert into
                aryAjax_Settings[4] = 'null';                                                   //The field to search on
                aryAjax_Settings[5] = 'null';                                                   //The value to limit by
                aryAjax_Settings[13] = '-1'                                                      //Limit response

                //Display management
                aryAjax_Settings[15] = 'divWarning';                                                   //Where to draw error messages if any

                //Common Functional settings
                aryAjax_Settings[6] = 'intCurrentIdOfRecordUpdated';                               //Has to be this value to match XML
                aryAjax_Settings[12] = 'Id Of Updated Record';                                            //XML header for troubleshooting
                aryAjax_Settings[17] = 'objAjaxReturnedId';                                         //Field on the current page where the matched CDA Id will be written

                //Function specific settings
                aryAjax_Settings[34] = 'strCDA_1285_field_0_1';                                     //Fields in other form to update
                aryAjax_Settings[35] = (parseInt(document.getElementById('strCDA_1291_field_0_37').value) + 1); //Values to update with in the other form
                aryAjax_Settings[36] = 'intCDA_1285_Id';                                            //Id field to match on
                aryAjax_Settings[37] = '1';                                       //Id value to match on
                aryAjax_Settings[28] = 'fn_FEXCO_GenerateRandomNumber();';                                  //Function to be executed after retrieval

            //Execute
            fn_Ajax_bxp_Process();                                                              //The main execution of the AJAX


        }
    }

    //***********************************************************************
    // Application   : Generate Random Number between 1000-9999
    //***********************************************************************
    function fn_FEXCO_GenerateRandomNumber() {
        document.getElementById('strCDA_1291_field_0_38').value = (Math.random() * 10000).toFixed(0);



    }


    //***********************************************************************
    // Application   : Set values for Application ID
    //***********************************************************************
    function fn_FEXCO_SetApplicationIDValues() {
        document.getElementById('strCDA_1291_field_0_39').value = document.getElementById('strCDA_1291_field_0_2').value.substring
            (document.getElementById('strCDA_1291_field_0_2').value.length - 1, document.getElementById('strCDA_1291_field_0_2').value.length);
        document.getElementById('strCDA_1291_field_0_40').value = document.getElementById('strCDA_1291_field_0_3').value.substring
            (document.getElementById('strCDA_1291_field_0_3').value.length - 1, document.getElementById('strCDA_1291_field_0_3').value.length);
        document.getElementById('strCDA_1291_field_0_41').value = document.getElementById('strCDA_1291_field_0_14').value.substring(0, 1);
        document.getElementById('strCDA_1291_field_0_42').value = document.getElementById('strCDA_1291_field_0_14').value.substring
            (document.getElementById('strCDA_1291_field_0_14').value.length - 1, document.getElementById('strCDA_1291_field_0_14').value.length);
    }

    //***********************************************************************
    // Application   : Set firstname and lastname characters to Uppercase
    //***********************************************************************
    function fn_FEXCO_SetToUppercase() {
        document.getElementById('strCDA_1291_field_0_43').value = document.getElementById('strCDA_1291_field_0_39').value.toUpperCase();
        document.getElementById('strCDA_1291_field_0_44').value = document.getElementById('strCDA_1291_field_0_40').value.toUpperCase();
    }

    //***********************************************************************
    // Application   : Create Application ID
    //***********************************************************************
    setTimeout(function fn_FEXCO_CreateApplicationID() {
        if (document.getElementById('strCDA_1291_field_0_36').value.length == 0) {
            document.getElementById('strCDA_1291_field_0_36').value = document.getElementById('strCDA_1291_field_0_43').value +
                document.getElementById('strCDA_1291_field_0_44').value +
                document.getElementById('intCDA_Id').value +
                document.getElementById('strCDA_1291_field_0_38').value +
                document.getElementById('strCDA_1291_field_0_41').value +
                document.getElementById('strCDA_1291_field_0_42').value;

        }
        MPRNCheck();
    }, 5000);

    //***********************************************************************
    // Application   : Send Emails Hidden Field
    //***********************************************************************

    function trimIban() {
        var Iban = document.getElementById('strCDA_1291_field_0_75').value;
        var trimIban = Iban.split(" ").join("");

        Iban = trimIban;
        document.getElementById('strCDA_1291_field_0_75').value = Iban;
        //alert(Iban);



    }


    function BicDigits() {

        var bicEnd = "XXX";
        if (document.getElementById('strCDA_1291_field_0_76').value.length == 5) {

            document.getElementById('strCDA_1291_field_0_76').value += bicEnd;
        }

    }



    function HideShowTabs() {


        if (document.getElementById('intSystemGenerated_Client_Role').value == 2 || document.getElementById('intSystemGenerated_Client_Role').value == 6 || document.getElementById('intSystemGenerated_Client_Role').value == 3 || document.getElementById('intSystemGenerated_UserId').value == 144) {

            document.getElementById('liTab_strCDA_1291_field_0_125_tableid_31').style.display = 'none';

        }

        else {

            document.getElementById('liTab_strCDA_1291_field_0_125_tableid_31').style.display = 'inline';
        }
    }

    /*if(document.getElementById('intSystemGenerated_Client_Role').value==3 && document.getElementById('strPreviousStatus').value=="Ready for Payment" || document.getElementById('strPreviousStatus').value=="Represent - Ready for Payment"||
    document.getElementById('strPreviousStatus').value=="Payment Complete"){ 
    
    ReadonlyFields();
    
    }*/


    if (document.getElementById('intSystemGenerated_Client_Role').value == 6) {

        ReadonlyFields();

    }

    function hiddenGrantPayableField() {

        if (document.getElementById('strCDA_1291_field_0_107').value == "") {

            document.getElementById('strCDA_1291_field_0_222').value = "600";

        }
        else if (document.getElementById('strCDA_1291_field_0_107').value != "") {

            document.getElementById('strCDA_1291_field_0_222').value = document.getElementById('strCDA_1291_field_0_107').value;

        }
    }



    function ReadonlyFields() {

        document.getElementById("strCDA_1291_field_0_10").readOnly = true;
        document.getElementById("strCDA_1291_field_0_11").readOnly = true;
        document.getElementById("strCDA_1291_field_0_12").readOnly = true;
        document.getElementById("strCDA_1291_field_0_13").readOnly = true;
        document.getElementById("strCDA_1291_field_0_14").readOnly = true;
        document.getElementById("strCDA_1291_field_0_15").readOnly = true;
        document.getElementById("strCDA_1291_field_0_2").readOnly = true;
        document.getElementById("strCDA_1291_field_0_3").readOnly = true;
        document.getElementById("strCDA_1291_field_0_4").readOnly = true;
        document.getElementById("strCDA_1291_field_0_5").readOnly = true;
        document.getElementById("strCDA_1291_field_0_6").readOnly = true;
        document.getElementById("strCDA_1291_field_0_7").readOnly = true;


        document.getElementById('strCDA_1291_field_0_210').value = document.getElementById("strCDA_1291_field_0_1").value;
        document.getElementById('strCDA_1291_field_0_211').value = document.getElementById("strCDA_1291_field_0_8").value;
        document.getElementById('strCDA_1291_field_0_212').value = document.getElementById("strCDA_1291_field_0_9").value;
        document.getElementById('strCDA_1291_field_0_213').value = document.getElementById("strCDA_1291_field_0_16").value;
        document.getElementById('strCDA_1291_field_0_214').value = document.getElementById("strCDA_1291_field_0_17").value;
        document.getElementById('strCDA_1291_field_0_215').value = document.getElementById("strCDA_1291_field_0_18").value;
        document.getElementById('strCDA_1291_field_0_216').value = document.getElementById("strCDA_1291_field_0_19").value;
        document.getElementById('strCDA_1291_field_0_217').value = document.getElementById("strCDA_1291_field_0_20").value;
        document.getElementById('strCDA_1291_field_0_218').value = document.getElementById("strCDA_1291_field_0_21").value;

        document.getElementById("strCDA_1291_field_0_210").readOnly = true;
        document.getElementById("strCDA_1291_field_0_211").readOnly = true;
        document.getElementById("strCDA_1291_field_0_213").readOnly = true;
        document.getElementById("strCDA_1291_field_0_214").readOnly = true;
        document.getElementById("strCDA_1291_field_0_215").readOnly = true;
        document.getElementById("strCDA_1291_field_0_216").readOnly = true;
        document.getElementById("strCDA_1291_field_0_217").readOnly = true;
        document.getElementById("strCDA_1291_field_0_218").readOnly = true;

        document.getElementById("strCDA_1291_field_0_74").readOnly = true;
        document.getElementById("strCDA_1291_field_0_75").readOnly = true;
        document.getElementById("strCDA_1291_field_0_76").readOnly = true;
        document.getElementById("strCDA_1291_field_0_69").readOnly = true;
        document.getElementById("strCDA_1291_field_0_70").readOnly = true;
        document.getElementById("strCDA_1291_field_0_116").readOnly = true;
        document.getElementById("strCDA_1291_field_0_90").readOnly = true;
        document.getElementById("strCDA_1291_field_0_91").readOnly = true;
        document.getElementById("strCDA_1291_field_0_101").readOnly = true;
        document.getElementById("strCDA_1291_field_0_93").readOnly = true;
        document.getElementById("strCDA_1291_field_0_94").readOnly = true;
        document.getElementById("strCDA_1291_field_0_105").readOnly = true;
        document.getElementById("strCDA_1291_field_0_106").readOnly = true;
        document.getElementById("strCDA_1291_field_0_187").readOnly = true;
        document.getElementById("strCDA_1291_field_0_107").readOnly = true;


        document.getElementById("tableid_210").style.display = 'inline';
        document.getElementById("tableid_211").style.display = 'inline';
        document.getElementById("tableid_212").style.display = 'inline';
        document.getElementById("tableid_213").style.display = 'inline';
        document.getElementById("tableid_214").style.display = 'inline';
        document.getElementById("tableid_215").style.display = 'inline';
        document.getElementById("tableid_216").style.display = 'inline';
        document.getElementById("tableid_217").style.display = 'inline';
        document.getElementById("tableid_218").style.display = 'inline';

        document.getElementById("tableid_1").style.display = 'none';
        document.getElementById("tableid_8").style.display = 'none';
        document.getElementById("tableid_9").style.display = 'none';
        document.getElementById("tableid_1").style.display = 'none';
        document.getElementById("tableid_16").style.display = 'none';
        document.getElementById("tableid_17").style.display = 'none';
        document.getElementById("tableid_18").style.display = 'none';
        document.getElementById("tableid_19").style.display = 'none';
        document.getElementById("tableid_20").style.display = 'none';
        document.getElementById("tableid_21").style.display = 'none';
        document.getElementById("tableid_17").style.display = 'none';
        document.getElementById("tableid_18").style.display = 'none';
        document.getElementById("tableid_20").style.display = 'none';
        document.getElementById("tableid_21").style.display = 'none';
        document.getElementById("strCDA_1291_field_0_22").readOnly = true;
        document.getElementById("strCDA_1291_field_0_23").readOnly = true;



    }


    function MirrorTotalCost() {

        if (document.getElementById("strCDA_1291_field_0_187").value <= 600) {

            document.getElementById("strCDA_1291_field_0_107").value = document.getElementById("strCDA_1291_field_0_187").value;

        }
        else if (document.getElementById("strCDA_1291_field_0_187").value > 600) {
            document.getElementById("strCDA_1291_field_0_107").value = 600;
        }
    }

    function taxiDispaly() {
        var user_id = document.getElementById('intSystemGenerated_UserId');
        //debugger;
        if (user_id.value == "1085" || user_id.value == "1033" || user_id.value == "549" || user_id.value == "1120" || user_id.value == "1053") {
            document.getElementById('liTab_strCDA_1291_field_0_125_tableid_126').style.display = 'inline';
        }
        if ((document.getElementById('intSystemGenerated_Client_Role').value == 3) && (document.getElementById('strCDA_1291_field_0_58').value == '' || document.getElementById('strCDA_1291_field_0_58').value == 'N/A' || document.getElementById('strCDA_1291_field_0_59').value == 'N/A' || document.getElementById('strCDA_1291_field_0_59').value == '')) {

            document.getElementById('liTab_strCDA_1291_field_0_125_tableid_126').style.display = 'none';

        }

        else {

            document.getElementById('liTab_strCDA_1291_field_0_125_tableid_126').style.display = 'inline';

        }
      
    }


    function previewModal() {
        var strBuf = '';
        if (bxpFormOutcome.value == 'Email Payment Declined') {
            $JQ('.modal-body').empty();
            strBuf = '<p><strong>Contact Name: </strong> ' + FirstName.value + '' + LastName.value + '</p>'
                + '<p><strong>Application Number:</strong>' + document.getElementById('strCDA_1291_field_0_36').value + '</p>'
                + '<p><strong>Taxi Payment Decline Reasons: </strong>' + TaxiApplicant_Decline.value + '</p>'
                + '<p><strong>Applicant Payment Decline Reasons: </strong>' + Applicant_Decline.value + '</p>'
                + '<p><strong>Vehicle Registration Check Payment Decline Reasons: </strong>' + VehRegDecline.value + '</p>'

                + '<p><strong>Certificate 3 Decline Payment Reasons: </strong>' + Cert3Decline.value + '</p>'
                + '<p><strong>Test Record Sheet Decline Payment Reasons: </strong>' + TestRecordSheetDecline.value + '</p>'
                + '<p><strong>EV Decline Payment Reasons: </strong>' + EvDecline.value + '</p>'
                + '<p><strong>EV Charger Decline Payment Reasons: </strong>' + EvChargeDecline.value + '</p>'

        }
        else if (bxpFormOutcome.value == 'Email Payment Rejection - Pending Documentation') {
            $JQ('.modal-body').empty();
            strBuf = '<p><strong>Contact Name: </strong> ' + FirstName.value + '' + LastName.value + '</p>'
                + '<p><strong>Application Number:</strong>' + document.getElementById('strCDA_1291_field_0_36').value + '</p>'
                + '<p><strong>Taxi Payment Rejection Reasons: </strong>' + TaxiApplicants_Rejection.value + '</p>'
                + '<p><strong>Payment Request Form Rejection Reasons: </strong>' + PaymentRequestForm_Rejection.value + '</p>'
                + '<p><strong>Vehicle Registration Check Payment Rejection Reasons: </strong>' + VehicleRegCheck_Rejection.value + '</p>'
                + '<p><strong>Registered Electric Contractor of Ireland (REC) Rejection Payment Reasons: </strong>' + REC_Rejection.value + '</p>'
                + '<p><strong>Certificate 3 Rejection Payment Reasons: </strong>' + Certificate3_Rejection.value + '</p>'
                + '<p><strong>Payment Signature Rejection Reason: </strong>' + document.getElementById('strCDA_1291_field_0_221').value + '</p>'
                + '<p><strong>Supporting Documentation Rejection Payment Reasons: </strong>' + document.getElementById('strCDA_1291_field_0_161').value + '</p>'
                + '<p><strong>Test Record Sheet Rejection Payment Reasons: </strong>' + RecordSheet_Rejection.value + '</p>'
                + '<p><strong>EvCharger Point Rejection Reasons: </strong>' + EvChargerPoint_Rejection.value + '</p>'

        }
        else if (bxpFormOutcome.value == 'Email Pending Applicant Bank Mandate') {
            $JQ('.modal-body').empty();
            strBuf = '<p><strong>Contact Name: </strong> ' + FirstName.value + ' ' + LastName.value + '</p>'
                + '<p><strong>Application Number:</strong>' + document.getElementById('strCDA_1291_field_0_36').value + '</p>'
                + '<p><strong>Payment Made On:</strong>' + document.getElementById('strCDA_1291_field_0_34').value + '</p>'

        }

        else if (bxpFormOutcome.value == 'Email Resend Payment Form') {
            $JQ('.modal-body').empty();
            strBuf = '<p><strong>Contact Name: </strong> ' + FirstName.value + ' ' + LastName.value + '</p>'
                + '<p><strong>Application Number:</strong>' + document.getElementById('strCDA_1291_field_0_36').value + '</p>'
                + '<p><strong>Grant Expiry Date:</strong>' + document.getElementById('strCDA_1291_field_0_33').value + '</p>'

        }

        else if (bxpFormOutcome.value == 'Taxi Qualification Required') {
            $JQ('.modal-body').empty();
            strBuf = '<p><strong>Contact Name: </strong> ' + FirstName.value + ' ' + LastName.value + '</p>'
                + '<p><strong>Application Number:</strong>' + document.getElementById('strCDA_1291_field_0_36').value + '</p>'
                + '<p><strong>SPSV Vehicle Licence Number:</strong>' + document.getElementById('strCDA_1291_field_0_58').value + '</p>'
                + '<p><strong>E-SPSV Case Reference Number:</strong>' + document.getElementById('strCDA_1291_field_0_59').value + '</p>'

        }

        else if (bxpFormOutcome.value == 'Application Declined') {
            $JQ('.modal-body').empty();
            strBuf = '<p><strong>Contact Name: </strong> ' + FirstName.value + ' ' + LastName.value + '</p>'
                + '<p><strong>Application Number:</strong>' + document.getElementById('strCDA_1291_field_0_36').value + '</p>'
                + '<p><strong>Decline Reason</strong>' + document.getElementById('strCDA_1291_field_0_51').value + '</p>'


        }
        else if (bxpFormOutcome.value == 'Application Rejected') {
            $JQ('.modal-body').empty();
            strBuf = '<p><strong>Contact Name: </strong> ' + FirstName.value + ' ' + LastName.value + '</p>'
                + '<p><strong>Application Number:</strong>' + document.getElementById('strCDA_1291_field_0_36').value + '</p>'
                + '<p><strong>Rejection Reason</strong>' + document.getElementById('strCDA_1291_field_0_48').value + '</p>'


        }

        $JQ('.modal-body').append(strBuf);
    }




    function oneYes() {

        if (document.getElementById('strCDA_1291_field_0_45').value == "Yes" && document.getElementById('strCDA_1291_field_0_46').value == "No" && document.getElementById('strCDA_1291_field_0_47').value == "No") {

            document.getElementById('strCDA_1291_field_0_48').value = "MPRN (Meter Point Reference number) provided does not appear to be a valid number as cannot be found on ESB Networks registry.";

        }
        else if (document.getElementById('strCDA_1291_field_0_45').value == "Yes" && document.getElementById('strCDA_1291_field_0_46').value == "Yes" && document.getElementById('strCDA_1291_field_0_47').value == "No") {

            document.getElementById('strCDA_1291_field_0_48').value = "MPRN (Meter Point Reference number) provided does not appear to be a valid number as cannot be found on ESB Networks registry <br>"

                + "MPRN (Meter Point Reference number) provided does correlate with the address details provided for the Electric Vehicle Grant Scheme application";
        }

        else if (document.getElementById('strCDA_1291_field_0_45').value == "Yes" && document.getElementById('strCDA_1291_field_0_46').value == "Yes" && document.getElementById('strCDA_1291_field_0_47').value == "Yes") {

            document.getElementById('strCDA_1291_field_0_48').value = "MPRN (Meter Point Reference number) provided does not appear to be a valid number as cannot be found on ESB Networks registry<br>"
                + "MPRN (Meter Point Reference number) provided does correlate with the address details provided for the Electric Vehicle Grant Scheme application<br>"
                + "Address provided on the application form does not appear to match the address assigned to the MPRN (Meter Point Reference number) provided.";
        }
        else if (document.getElementById('strCDA_1291_field_0_45').value == "No" && document.getElementById('strCDA_1291_field_0_46').value == "Yes" && document.getElementById('strCDA_1291_field_0_47').value == "No") {

            document.getElementById('strCDA_1291_field_0_48').value = "MPRN (Meter Point Reference number) provided does correlate with the address details provided for the Electric Vehicle Grant Scheme application";

        }

        else if (document.getElementById('strCDA_1291_field_0_45').value == "No" && document.getElementById('strCDA_1291_field_0_46').value == "Yes" && document.getElementById('strCDA_1291_field_0_47').value == "Yes") {

            document.getElementById('strCDA_1291_field_0_48').value = "MPRN (Meter Point Reference number) provided does correlate with the address details provided for the Electric Vehicle Grant Scheme application <br>" +

                "Address provided on the application form does not appear to match the address assigned to the MPRN (Meter Point Reference number) provided.";

        }

        else if (document.getElementById('strCDA_1291_field_0_45').value == "Yes" && document.getElementById('strCDA_1291_field_0_46').value == "No" && document.getElementById('strCDA_1291_field_0_47').value == "Yes") {

            document.getElementById('strCDA_1291_field_0_48').value = "MPRN (Meter Point Reference number) provided does not appear to be a valid number as cannot be found on ESB Networks registry <br>" +

                "Address provided on the application form does not appear to match the address assigned to the MPRN (Meter Point Reference number) provided.";

        }
        else if (document.getElementById('strCDA_1291_field_0_45').value == "No" && document.getElementById('strCDA_1291_field_0_46').value == "No" && document.getElementById('strCDA_1291_field_0_47').value == "Yes") {

            document.getElementById('strCDA_1291_field_0_48').value =
                "Address provided on the application form does not appear to match the address assigned to the MPRN (Meter Point Reference number) provided.";

        }

        else if (document.getElementById('strCDA_1291_field_0_45').value == "No" && document.getElementById('strCDA_1291_field_0_46').value == "No" && document.getElementById('strCDA_1291_field_0_47').value == "No") {

            document.getElementById('strCDA_1291_field_0_48').value =
                "";

        }
    }

    var notEligibleNoAlreadyReceivedHomeCharger = document.getElementById('strCDA_1291_field_0_49');
    var notEligibleOutsideRegistration = document.getElementById('strCDA_1291_field_0_50');
    var newReason = document.getElementById('strCDA_1291_field_0_226');
    var applicantsNameDoesNotMatch = document.getElementById('strCDA_1291_field_0_231');

    var declineReasons = document.getElementById('strCDA_1291_field_0_51');


    var yesNotEligibleNoAlreadyReceivedHomeCharger = " MPRN (Meter Point Reference number) provided appears to be associated with an Electric Vehicle Grant which has already received a free ESB Ecars Home Charger pre 2018.";
    var yesNotEligibleOutsideRegistration = " The car registration appears to be outside of the eligibility criteria. Only vehicles registered new or bought second hand from 2018 onwards are eligible.";
    var yesnotEligiblePrivatelyRegistered = " The car registration appears to be outside of the eligibility criteria. Only vehicles privately registered are eligible for the scheme.";
    var yesApplicantsNameDoesNotMatch = " The applicants name does not appear to match the name on the EV purchase grant.";

    message = "";
    function DeclineEmail() {
        message = "";
        if (notEligibleNoAlreadyReceivedHomeCharger.value == "Yes") {
            message += yesNotEligibleNoAlreadyReceivedHomeCharger;

        }
        if (notEligibleOutsideRegistration.value == "Yes") {
            message += yesNotEligibleOutsideRegistration;
        }

        if (newReason.value == "Yes") {
            message += yesnotEligiblePrivatelyRegistered;
        }

        if (applicantsNameDoesNotMatch.value == "Yes") {
            message += yesApplicantsNameDoesNotMatch;
        }
        declineReasons.value = message;
        console.log(message);
    }


    var aresclationReason = new Array('NULL', 'Application Rejected');
    function RejectionReasons() {
        var strContact_Outcome = document.getElementById('strContact_Outcome');
        for (var i = 0; i < aresclationReason.length; i++) {

            if (strContact_Outcome.value == aresclationReason[i]) {

                document.getElementById('tableid_45').style.display = 'inline';
                document.getElementById('tableid_46').style.display = 'inline';
                document.getElementById('tableid_47').style.display = 'inline';

            } else {
                document.getElementById('tableid_45').style.display = 'none';
                document.getElementById('tableid_46').style.display = 'none';
                document.getElementById('tableid_47').style.display = 'none';

            }
        }
    }

    var DeclineReason = new Array('NULL', 'Application Declined');
    function DeclineReasons() {
        var strContact_Outcome = document.getElementById('strContact_Outcome');
        for (var i = 0; i < DeclineReason.length; i++) {

            if (strContact_Outcome.value == DeclineReason[i]) {

                document.getElementById('tableid_49').style.display = 'inline';
                document.getElementById('tableid_50').style.display = 'inline';


            } else {
                document.getElementById('tableid_49').style.display = 'none';
                document.getElementById('tableid_50').style.display = 'none';


            }
        }
    }

    function Ev_Charge_Point_Decline() {

        if (document.getElementById('strCDA_1291_field_0_103').value == 'Yes') {

            document.getElementById('strCDA_1291_field_0_196').value = '<li> EV Charge Point Fitted before Work Started</li>';
        }
        else {

            document.getElementById('strCDA_1291_field_0_196').value = '';

        }
    }

    function Ev_Charge_Point_VehicleDecline() {

        if (document.getElementById('strCDA_1291_field_0_104').value == 'No') {

            document.getElementById('strCDA_1291_field_0_197').value = '<li> EV Charge Point and vehicle are not parked off-street and not within the confines of the property of the applicant</li>';
        }
        else {

            document.getElementById('strCDA_1291_field_0_197').value = '';

        }
    }

    function process_PayemntRejections(PayRej1, PayRej2, PayRej3, PayRej4, PayRej5, PayRej6, PayRej7, PayRej8, PayRej9) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_113');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }
        if (RejectPayments[2].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej3 + '</li>';
        }
        if (RejectPayments[3].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej4 + '</li>';
        }
        if (RejectPayments[4].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej5 + '</li>';
        }
        if (RejectPayments[5].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej6 + '</li>';
        }
        if (RejectPayments[6].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej7 + '</li>';
        }
        if (RejectPayments[7].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej8 + '</li>';
        }
        if (RejectPayments[8].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej9 + '</li>';
        }

        return full_text;
    }


    function process_SupportingDocRejectingReasons(PayRej1, PayRej2, PayRej3) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_135');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }
        if (RejectPayments[2].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej3 + '</li>';
        }
        return full_text;
    }

    function process_TaxiApplicantsRejectionReasons(PayRej1, PayRej2, PayRej3) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_139');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }
        if (RejectPayments[2].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej3 + '</li>';
        }

        return full_text;
    }


    function process_PaymentSignatureRejectionReasons(PayRej1) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_220');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }

        return full_text;
    }

    function process_RecRejectionReasons(PayRej1, PayRej2, PayRej3) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_152');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }
        if (RejectPayments[2].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej3 + '</li>';
        }

        return full_text;
    }

    function process_TestRecordSheetRej(PayRej1, PayRej2, PayRej3, PayRej4, PayRej5) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_154');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }
        if (RejectPayments[2].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej3 + '</li>';
        }
        if (RejectPayments[3].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej4 + '</li>';
        }
        if (RejectPayments[4].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej5 + '</li>';
        }

        return full_text;
    }

    function process_CheckCosts(PayRej1, PayRej2) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_155');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }
        return full_text;
    }

    function process_RegCheck(PayRej1, PayRej2, PayRej3, PayRej4) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_156');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }
        if (RejectPayments[2].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej3 + '</li>';
        }
        if (RejectPayments[3].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej4 + '</li>';
        }
        return full_text;
    }

    function process_DeclineApplicant(PayRej1, PayRej2, PayRej3) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_169');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }
        if (RejectPayments[2].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej3 + '</li>';
        }

        return full_text;
    }

    function process_TaxiDecline(PayRej1, PayRej2) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_171');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }

        return full_text;
    }

    function process_Cert3Rej(PayRej1, PayRej2, PayRej3, PayRej4) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_153');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }
        if (RejectPayments[2].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej3 + '</li>';
        }
        if (RejectPayments[3].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej4 + '</li>';
        }
        return full_text;
    }

    function process_VehRegDecline(PayRej1, PayRej2, PayRej3, PayRej4) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_175');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }
        if (RejectPayments[2].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej3 + '</li>';
        }
        if (RejectPayments[3].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej4 + '</li>';
        }

        return full_text;
    }

    function process_Cert3Decline(PayRej1, PayRej2) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_173');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }
        return full_text;
    }

    function process_TestRecordDecline(PayRej1, PayRej2) {
        var RejectPayments = document.getElementsByName('strCDA_1291_field_0_177');
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (RejectPayments[0].checked == true) {// if address not blank, add to text box
            full_text += '<li>' + ' ' + ',' + PayRej1 + '</li>';
        }
        if (RejectPayments[1].checked == true) {
            full_text += '<li>' + ' ' + ',' + PayRej2 + '</li>';
        }
        return full_text;
    }




    function FEXCO_process_address_InLine(address1, address2, address3, address4, address5, eircode) {
        var full_text = "";
        //Put entire address in a div and set height of table to remain fixed
        if (address1.value != '') {// if address not blank, add to text box
            full_text += ' ' + address1.value;
        }
        if (address2.value != '') {
            full_text += '' + ',' + address2.value;
        }
        if (address3.value != '') {
            full_text += '' + ',' + address3.value;
        }
        if (address4.value != '') {
            full_text += '' + ',' + address4.value;
        }
        if (address5.value != '') {
            full_text += '' + ',' + address5.value;
        }
        if (eircode.value != '') {
            full_text += '' + ',' + eircode.value;
        }
        return full_text;
    }
    function FEXCO_process_address(title, name1, name2, address1, address2, address3, address4, address5, eircode) {
        var full_text = "";
        if (name1.value != '') {
            full_text += title.value + ' ' + name1.value;
        }
        if (name2.value != '') {

            full_text += ' ' + name2.value + ',';
        }

        //Put entire address in a div and set height of table to remain fixed
        if (address1.value != '') {// if address not blank, add to text box
            full_text += ' ' + address1.value;
        }
        if (address2.value != '') {
            full_text += '' + ',' + address2.value;
        }
        if (address3.value != '') {
            full_text += '' + ',' + address3.value;
        }
        if (address4.value != '') {
            full_text += '' + ',' + address4.value;
        }
        if (address5.value != '') {
            full_text += '' + ',' + address5.value;
        }
        if (eircode.value != '') {
            full_text += '' + ',' + eircode.value;
        }
        return full_text;
    }



    if (document.getElementById('strCDA_1291_field_0_58').value == "") {

        document.getElementById('strCDA_1291_field_0_58').value = "N/A";
    }

    if (document.getElementById('strCDA_1291_field_0_59').value == "") {

        document.getElementById('strCDA_1291_field_0_59').value = "N/A";
    }


    // A $( document ).ready() block.
    $JQ(document).ready(function () {
        //The following code takes the concatenated name/address fields from the API and splits them on Cap Letters
        //It also removes the [bxp_Comma] tag that is appended to some strings if a comma is entered into the web form in error






        var title_field = document.getElementById('strCDA_1291_field_0_1');
        var firstName = document.getElementById('strCDA_1291_field_0_2');
        var surName = document.getElementById('strCDA_1291_field_0_3');
        var addressfield1 = document.getElementById('strCDA_1291_field_0_4');
        var addressfield2 = document.getElementById('strCDA_1291_field_0_5');
        var addressfield3 = document.getElementById('strCDA_1291_field_0_6');
        var town_field = document.getElementById('strCDA_1291_field_0_7');
        var county_field = document.getElementById('strCDA_1291_field_0_8');
        var eircode_field = document.getElementById('strCDA_1291_field_0_15');

        var vehicle_purchase_type = document.getElementById('strCDA_1291_field_0_9');

        if (vehicle_purchase_type.value !== '') {
            tempoary_var = vehicle_purchase_type.value.replace(/([A-Z])/g, ' $1').trim();
            vehicle_purchase_type.value = tempoary_var;

            if (vehicle_purchase_type.options[1].value == 'SecondHand' || vehicle_purchase_type.options[1].value == 'SecondHandImport' || vehicle_purchase_type.options[1].value == 'New Import') {
                vehicle_purchase_type.remove(1);
            }
        }

        //Get Address fields and concat into one text area for PDF output
        full_address_hidden = document.getElementById('strCDA_1291_field_0_52');
        full_address_hidden.value = '';
        full_address_hidden.innerHTML = '';

        full_address_hidden_line = document.getElementById('strCDA_1291_field_0_53');
        full_address_hidden_line.value = '';
        full_address_hidden_line.innerHTML = '';


        updateAddressBoxes();








        title_field.onchange = function () {
            updateAddressBoxes();
        };
        firstName.onchange = function () {
            updateAddressBoxes();
        };
        surName.onchange = function () {
            updateAddressBoxes();
        };
        addressfield1.onchange = function () {
            updateAddressBoxes();
        };
        addressfield2.onchange = function () {
            updateAddressBoxes();
        };
        addressfield3.onchange = function () {
            updateAddressBoxes();
        };
        town_field.onchange = function () {
            updateAddressBoxes();
        };
        county_field.onchange = function () {
            updateAddressBoxes();
        };
        eircode_field.onchange = function () {
            updateAddressBoxes();
        };


        //******************************************************************************************************
        // Application   : This function that attempts to lock the record to the current logged in user
        //******************************************************************************************************
        function fn_Fexco_AttemptRecordLocking() {

            // * Check to see if its a new record or an exiting record
            if (intCDA_Id.value != 0) {

                //alert('Please wait while locking is attempted');

                // * Check the current locking status
                fn_Fexco_AJAX_GetCurrentLockStatus();

                setTimeout(function () {
                    if (objHiddenField_RecordLockedTo.value == '') {

                        // * Set the locking status
                        setTimeout(function () { fn_Fexco_AJAX_SetCurrentLockStatus(); }, 450);

                        // * Check to see the locking status to make sure the lock has been set
                        setTimeout(function () { fn_Fexco_AJAX_GetCurrentLockStatus(); }, 500);
                        setTimeout(function () { fn_Fexco_CheckLockingStatus(); }, 550);

                    }
                    else {

                        // * Check to see the locking status to make sure the lock has been set
                        fn_Fexco_AJAX_GetCurrentLockStatus();
                        setTimeout(function () { fn_Fexco_CheckLockingStatus(); }, 450);
                    }
                }, 350);
            }
            else {
                objHiddenField_tableid_X.style.display = 'none';
            }
        }


        //******************************************************************************************************
        // Application   :  This function handles an AJAX call that gets the current locking status of he record
        //******************************************************************************************************
        function fn_Fexco_AJAX_GetCurrentLockStatus() {

            // * Construct the AJAX array
            if (typeof aryAjax_Settings == 'undefined')
                alert('Library did not load');
            else {

                aryAjax_Settings[0] = 'client_fexco';
                aryAjax_Settings[1] = '';
                aryAjax_Settings[2] = '';

                aryAjax_Settings[3] = intCampaign_Id.value;
                aryAjax_Settings[4] = 'intCDA_' + intCampaign_Id.value + '_Id';
                aryAjax_Settings[5] = intCDA_Id.value;

                aryAjax_Settings[13] = -1;
                aryAjax_Settings[14] = 'false';
                aryAjax_Settings[15] = 'divWarning';
                aryAjax_Settings[16] = 'Insert';

                aryAjax_Settings[6] = objHiddenField_RecordLockedTo.id;
                aryAjax_Settings[12] = 'id,CurrentLockedRecord';
                aryAjax_Settings[17] = objHiddenField_RecordLockedTo.id;

                aryAjax_Settings[22] = document.getElementById('intSystemGenerated_CompanyId').value;
                aryAjax_Settings[23] = document.getElementById('intSystemGenerated_UserId').value;
                aryAjax_Settings[24] = document.getElementById('intSystemGenerated_LoginKey').value;

                // * Execute the AJAX function
                fn_Ajax_BE_Process();

            }
        }

        //******************************************************************************************************
        // Application   : This function handles the AJAX function that locks the record to the current agent
        //******************************************************************************************************
        function fn_Fexco_AJAX_SetCurrentLockStatus() {

            // * Construct the AJAX array
            if (typeof aryAjax_Settings == 'undefined')
                alert('Library did not load');
            else {

                aryAjax_Settings[0] = 'client_fexco';
                aryAjax_Settings[1] = '';
                aryAjax_Settings[2] = '';

                aryAjax_Settings[3] = intCampaign_Id.value;
                aryAjax_Settings[4] = 'null';
                aryAjax_Settings[5] = 'null';

                aryAjax_Settings[13] = -1;
                aryAjax_Settings[14] = 'false';
                aryAjax_Settings[15] = '';
                aryAjax_Settings[16] = 'dbUpdateRecord';

                aryAjax_Settings[6] = objHiddenField_intCDA_X_id.id;
                aryAjax_Settings[12] = 'Id Of Updated Record';
                aryAjax_Settings[17] = objHiddenField_intCDA_X_id.id;

                aryAjax_Settings[22] = document.getElementById('intSystemGenerated_CompanyId').value;
                aryAjax_Settings[23] = document.getElementById('intSystemGenerated_UserId').value;
                aryAjax_Settings[24] = document.getElementById('intSystemGenerated_LoginKey').value;

                aryAjax_Settings[34] = 'strCDA_' + intCampaign_Id.value + '_status,' + objHiddenField_RecordLockedTo.id;
                aryAjax_Settings[35] = 'Taken To Process,' + intCDA_X_StaffId.value;
                aryAjax_Settings[36] = 'intCDA_' + intCampaign_Id.value + '_Id';
                aryAjax_Settings[37] = intCDA_Id.value;
                aryAjax_Settings[38] = 'False';
                //aryAjax_Settings[39] 								= 	'Record Locked By Agent';					

                // * Execute the AJAX function
                fn_Ajax_BE_Process();

            }
        }

        //******************************************************************************************************
        // Application   : This function releases the locl on the records
        //******************************************************************************************************
        function fn_Fexco_ReleaseRecordLocking() {

            // *Set the lock field to be blank (release the lock) and then run the standard BeX closing function
            objHiddenField_RecordLockedTo.value = '';
            js_fn_Master_Validation_Script(document.getElementById('strContact_Outcome'));
        }

        //******************************************************************************************************
        // Application   : This function handles any operations onload
        //******************************************************************************************************
        function fn_Fexco_TidyOnLoad() {

            // * Set the onclick event of the button to be our new function so it always releases the records
            btn_submit.onclick = function () { fn_Fexco_ReleaseRecordLocking(); }
        }




        function updateAddressBoxes() {
            var full_address = FEXCO_process_address(title_field, firstName, surName, addressfield1, addressfield2, addressfield3, town_field, county_field, eircode_field);


            tr = full_address.replace(/,/g, ',<br />');
            full_address_hidden.value = tr;

            full_address_hidden_line.value = '';
            var full_address_inLine = FEXCO_process_address_InLine(addressfield1, addressfield2, addressfield3, town_field, county_field, eircode_field);
            tr2 = full_address_inLine.replace(/,|, /g, ',');
            full_address_hidden_line.value = tr2;
        }

    });

    function showPostOutcomes() {
        $JQ('#strContact_Outcome option[value^="Phone"]').hide();
        $JQ('#strContact_Outcome option[value^="Email"]').hide();
        $JQ('#strContact_Outcome option[value^="Post"]').show();
        $JQ('#strContact_Outcome option[value^="Safe"]').hide();
        $JQ('#strContact_Outcome option[value^="Taxi"]').hide();
    }
    function showEmailOutcomes() {
        $JQ('#strContact_Outcome option[value^="Phone"]').hide();
        $JQ('#strContact_Outcome option[value^="Post"]').hide();
        $JQ('#strContact_Outcome option[value^="Email"]').show();
        $JQ('#strContact_Outcome option[value^="Safe"]').hide();
        $JQ('#strContact_Outcome option[value^="Taxi"]').hide();
    }

    function showTaxiOutcomes() {
        $JQ('#strContact_Outcome option[value^="Phone"]').hide();
        $JQ('#strContact_Outcome option[value^="Post"]').hide();
        $JQ('#strContact_Outcome option[value^="Email"]').hide();
        $JQ('#strContact_Outcome option[value^="Taxi"]').show();
        $JQ('#strContact_Outcome option[value^="Safe"]').hide();

    }

    function SafeElectricOutcomes() {
        $JQ('#strContact_Outcome option[value^="Phone"]').hide();
        $JQ('#strContact_Outcome option[value^="Post"]').hide();
        $JQ('#strContact_Outcome option[value^="Email"]').hide();
        $JQ('#strContact_Outcome option[value^="Taxi"]').hide();
        $JQ('#strContact_Outcome option[value^="Safe"]').show();


    }

    outwardChannelPost.onchange = function () {
        if (outwardChannelPost.checked == true) {
            showPostOutcomes();
        }
    }
    outwardChannelEmail.onchange = function () {
        if (outwardChannelEmail.checked == true) {
            showEmailOutcomes();
        }
    }

    outwardChannelSafe.onchange = function () {
        if (outwardChannelSafe.checked == true) {
            SafeElectricOutcomes();
        }
    }


    outwardChannelTaxi.onchange = function () {
        if (outwardChannelTaxi.checked == true) {
            showTaxiOutcomes();
        }
    }



    function AddLabour_Material() {


        var LabourCosts = document.getElementById('strCDA_1291_field_0_105');
        var MaterialCosts = document.getElementById('strCDA_1291_field_0_106');
        var TotalCostsGrant = document.getElementById('strCDA_1291_field_0_107');
        var ParseLabour = parseFloat(LabourCosts.value);
        var TotalCosts = document.getElementById('strCDA_1291_field_0_187');
        var ParseMaterial = parseFloat(MaterialCosts.value);

        TotalCosts = ((ParseLabour + ParseMaterial).toFixed(2));

        if (TotalCosts >= 600) {
            document.getElementById('strCDA_1291_field_0_107').value = 600
            document.getElementById('strCDA_1291_field_0_187').value = TotalCosts;
        }
        else {
            document.getElementById('strCDA_1291_field_0_187').value = TotalCosts;
            document.getElementById('strCDA_1291_field_0_107').value = TotalCosts;
        }
    }




    function CapTotalCosts() {

        if (document.getElementById('strCDA_1291_field_0_187').value >= 600) {
            document.getElementById('strCDA_1291_field_0_107').value = 600
        }

    }

    function CurrentMonth() {
        var Curdate = new Date();
        var CurMonth = Curdate.getMonth();
        document.getElementById("strCDA_1291_field_0_190").value = CurMonth;

    }

    function MonthName() {

        const MONTH_NAMES = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
            "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
        ];

        const d = new Date();
        var MonthName = MONTH_NAMES[d.getMonth()]
        document.getElementById('strCDA_1291_field_0_191').value = MonthName;

    }

    function removeSpecialChars() {
        var firstnameTrim = document.getElementById('strCDA_1291_field_0_2').value;
        firstnameTrim = firstnameTrim.replace(/[^a-zA-Z 0-9]+/g, '');
        return firstnameTrim;

    }

    function removeSpecialCharsSurname() {
        var secondnameTrim = document.getElementById('strCDA_1291_field_0_3').value;
        secondnameTrim = secondnameTrim.replace(/[^a-zA-Z 0-9]+/g, '');
        return secondnameTrim;

    }




    function updateRejectionReasons() {
        var PaymentRequestFormRejectReason1 = document.getElementsByName('strCDA_1291_field_0_113')[0].value;
        var PaymentRequestFormRejectReason2 = document.getElementsByName('strCDA_1291_field_0_113')[1].value;
        var PaymentRequestFormRejectReason3 = document.getElementsByName('strCDA_1291_field_0_113')[2].value;
        var PaymentRequestFormRejectReason4 = document.getElementsByName('strCDA_1291_field_0_113')[3].value;
        var PaymentRequestFormRejectReason5 = document.getElementsByName('strCDA_1291_field_0_113')[4].value;
        var PaymentRequestFormRejectReason6 = document.getElementsByName('strCDA_1291_field_0_113')[5].value;
        var PaymentRequestFormRejectReason7 = document.getElementsByName('strCDA_1291_field_0_113')[6].value;
        var PaymentRequestFormRejectReason8 = document.getElementsByName('strCDA_1291_field_0_113')[7].value;
        var PaymentRequestFormRejectReason9 = document.getElementsByName('strCDA_1291_field_0_113')[8].value;

        var SupportingDocRejectReason1 = document.getElementsByName('strCDA_1291_field_0_135')[0].value;
        var SupportingDocRejectReason2 = document.getElementsByName('strCDA_1291_field_0_135')[1].value;
        var SupportingDocRejectReason3 = document.getElementsByName('strCDA_1291_field_0_135')[2].value;

        var TaxiRejectReason1 = document.getElementsByName('strCDA_1291_field_0_139')[0].value;
        var TaxiRejectReason2 = document.getElementsByName('strCDA_1291_field_0_139')[1].value;
        var TaxiRejectReason3 = document.getElementsByName('strCDA_1291_field_0_139')[2].value;

        var RecRejectReason1 = document.getElementsByName('strCDA_1291_field_0_152')[0].value;
        var RecRejectReason2 = document.getElementsByName('strCDA_1291_field_0_152')[1].value;
        var RecRejectReason3 = document.getElementsByName('strCDA_1291_field_0_152')[2].value;

        var Cert3RejectReason1 = document.getElementsByName('strCDA_1291_field_0_153')[0].value;
        var Cert3RejectReason2 = document.getElementsByName('strCDA_1291_field_0_153')[1].value;
        var Cert3RejectReason3 = document.getElementsByName('strCDA_1291_field_0_153')[2].value;
        var Cert3RejectReason4 = document.getElementsByName('strCDA_1291_field_0_153')[3].value;

        var PaySignatureRejectReason1 = document.getElementsByName('strCDA_1291_field_0_220')[0].value;

        var TestRejectReason1 = document.getElementsByName('strCDA_1291_field_0_154')[0].value;
        var TestRejectReason2 = document.getElementsByName('strCDA_1291_field_0_154')[1].value;
        var TestRejectReason3 = document.getElementsByName('strCDA_1291_field_0_154')[2].value;
        var TestRejectReason4 = document.getElementsByName('strCDA_1291_field_0_154')[3].value;
        var TestRejectReason5 = document.getElementsByName('strCDA_1291_field_0_154')[4].value;

        var CostsRejectionReasons1 = document.getElementsByName('strCDA_1291_field_0_155')[0].value;
        var CostsRejectionReasons2 = document.getElementsByName('strCDA_1291_field_0_155')[1].value;

        var RegCheckReasons1 = document.getElementsByName('strCDA_1291_field_0_156')[0].value;
        var RegCheckReasons2 = document.getElementsByName('strCDA_1291_field_0_156')[1].value;
        var RegCheckReasons3 = document.getElementsByName('strCDA_1291_field_0_156')[2].value;
        var RegCheckReasons4 = document.getElementsByName('strCDA_1291_field_0_156')[3].value;

        var AppDeclineReason1 = document.getElementsByName('strCDA_1291_field_0_169')[0].value;
        var AppDeclineReason2 = document.getElementsByName('strCDA_1291_field_0_169')[1].value;
        var AppDeclineReason3 = document.getElementsByName('strCDA_1291_field_0_169')[2].value;

        var TaxiDeclineReason1 = document.getElementsByName('strCDA_1291_field_0_171')[0].value;
        var TaxiDeclineReason2 = document.getElementsByName('strCDA_1291_field_0_171')[1].value;

        var VehRegDeclineReason1 = document.getElementsByName('strCDA_1291_field_0_175')[0].value;
        var VehRegDeclineReason2 = document.getElementsByName('strCDA_1291_field_0_175')[1].value;
        var VehRegDeclineReason3 = document.getElementsByName('strCDA_1291_field_0_175')[2].value;
        var VehRegDeclineReason4 = document.getElementsByName('strCDA_1291_field_0_175')[3].value;

        var Cert3DeclineReason1 = document.getElementsByName('strCDA_1291_field_0_173')[0].value;
        var Cert3DeclineReason2 = document.getElementsByName('strCDA_1291_field_0_173')[1].value;

        var TestRecordDeclineReason1 = document.getElementsByName('strCDA_1291_field_0_177')[0].value;
        var TestRecordDeclineReason2 = document.getElementsByName('strCDA_1291_field_0_177')[1].value;

        var rejectpayBox = document.getElementById('strCDA_1291_field_0_115');
        var rejectpayBoxReasons = process_PayemntRejections(PaymentRequestFormRejectReason1, PaymentRequestFormRejectReason2, PaymentRequestFormRejectReason3, PaymentRequestFormRejectReason4, PaymentRequestFormRejectReason5, PaymentRequestFormRejectReason6,PaymentRequestFormRejectReason7,PaymentRequestFormRejectReason8,PaymentRequestFormRejectReason9)
        tr = rejectpayBoxReasons.replace(/,/g, '');
        rejectpayBox.value = tr;

        var rejectSupportDocField = document.getElementById('strCDA_1291_field_0_161');
        var SupportingDocReject = process_SupportingDocRejectingReasons(SupportingDocRejectReason1, SupportingDocRejectReason2, SupportingDocRejectReason3)
        ts = SupportingDocReject.replace(/,/g, '');
        rejectSupportDocField.value = ts;

        var rejectTaxiApplicantsTextArea = document.getElementById('strCDA_1291_field_0_162');
        var rejectTaxiApplicants = process_TaxiApplicantsRejectionReasons(TaxiRejectReason1, TaxiRejectReason2, TaxiRejectReason3)
        tg = rejectTaxiApplicants.replace(/,/g, '');
        rejectTaxiApplicantsTextArea.value = tg;


        var RecApplicantsAreaHidden = document.getElementById('strCDA_1291_field_0_163');
        var processRec = process_RecRejectionReasons(RecRejectReason1, RecRejectReason2, RecRejectReason3);
        tx = processRec.replace(/,/g, '');
        RecApplicantsAreaHidden.value = tx;

        var TestRecordSheetreaHidden = document.getElementById('strCDA_1291_field_0_164');
        var processTestRec = process_TestRecordSheetRej(TestRejectReason1, TestRejectReason2, TestRejectReason3, TestRejectReason4, TestRejectReason5);
        ty = processTestRec.replace(/,/g, '');
        TestRecordSheetreaHidden.value = ty;

        var CheckCostsHiddenArea = document.getElementById('strCDA_1291_field_0_165');
        var processCheckCosts = process_CheckCosts(CostsRejectionReasons1, CostsRejectionReasons2)
        tz = processCheckCosts.replace(/,/g, '');
        CheckCostsHiddenArea.value = tz;

        var RegCheckHiddenArea = document.getElementById('strCDA_1291_field_0_166');
        var processRegCheck = process_RegCheck(RegCheckReasons1, RegCheckReasons2, RegCheckReasons3, RegCheckReasons4)
        ti = processRegCheck.replace(/,/g, '');
        RegCheckHiddenArea.value = ti;

        var Cert3HiddenArea = document.getElementById('strCDA_1291_field_0_167');
        var processChertCheck = process_Cert3Rej(Cert3RejectReason1, Cert3RejectReason2, Cert3RejectReason3, Cert3RejectReason4);
        tt = processChertCheck.replace(/,/g, '');
        Cert3HiddenArea.value = tt;

        var PayDeclineHiddenArea = document.getElementById('strCDA_1291_field_0_170');
        var payDeclineReasonCode = process_DeclineApplicant(AppDeclineReason1, AppDeclineReason2, AppDeclineReason3);
        to = payDeclineReasonCode.replace(/,/g, '');
        PayDeclineHiddenArea.value = to;

        var TaxiDeclineHiddenArea = document.getElementById('strCDA_1291_field_0_172');
        var TaxiDeclineReasonCode = process_TaxiDecline(TaxiDeclineReason1, TaxiDeclineReason2);
        tc = TaxiDeclineReasonCode.replace(/,/g, '');
        TaxiDeclineHiddenArea.value = tc;

        var VehRegDeclineHiddenArea = document.getElementById('strCDA_1291_field_0_176');
        var VehRegDeclineReasonCode = process_VehRegDecline(VehRegDeclineReason1, VehRegDeclineReason2, VehRegDeclineReason3, VehRegDeclineReason4);
        vr = VehRegDeclineReasonCode.replace(/,/g, '');
        VehRegDeclineHiddenArea.value = vr;


        var Cert3DeclineHiddenArea = document.getElementById('strCDA_1291_field_0_178');
        var Cert3DeclineReasonCode = process_Cert3Decline(Cert3DeclineReason1, Cert3DeclineReason2);
        tb = Cert3DeclineReasonCode.replace(/,/g, '');
        Cert3DeclineHiddenArea.value = tb;

        var TestRecordDeclineHiddenArea = document.getElementById('strCDA_1291_field_0_179');
        var TestRecordDeclineReasonCode = process_TestRecordDecline(TestRecordDeclineReason1, TestRecordDeclineReason2);
        tf = TestRecordDeclineReasonCode.replace(/,/g, '');
        TestRecordDeclineHiddenArea.value = tf;

        var PaymentRejectSignatureHiddenArea = document.getElementById('strCDA_1291_field_0_221');
        var PaymentRejectSignatureReasonCode = process_PaymentSignatureRejectionReasons(PaySignatureRejectReason1);
        ta = PaymentRejectSignatureReasonCode.replace(/,/g, '');
        PaymentRejectSignatureHiddenArea.value = ta;


    }


    liTab_strCDA_1291_field_0_125_tableid_87.setAttribute("onClick", 'DocumentationLogic();');
    liTab_strCDA_1291_field_0_125_tableid_126.setAttribute("onClick", 'TaxiLogic();');
    liTab_strCDA_1291_field_0_125_tableid_108.setAttribute("onClick", 'VehRegCheckLogic();')
    liTab_strCDA_1291_field_0_125_tableid_73.setAttribute("onClick", 'PaymentLogic();')

    var firstnameTrimSymbols = document.getElementById('strCDA_1291_field_0_2').value.trim();
    firstnameTrimSymbols.replace(/s/g, '');





    function cleanSurname() {
        var removeCharSurname = [removeSpecialCharsSurname()];
        var removeCharSurnameString = removeCharSurname.toString();
        removeCharSurnameString = removeCharSurnameString.replace(/s/g, '');
        document.getElementById('strCDA_1291_field_0_3').value = removeCharSurnameString.trim();

    }

    function cleanFirstname() {
        var removeChar = [removeSpecialChars()];
        var removeCharSurnameString = removeChar.toString();
        removeCharSurnameString = removeCharSurnameString.replace(/s/g, '');
        document.getElementById('strCDA_1291_field_0_2').value = removeCharSurnameString.trim();

    }

    //document.getElementById('strCDA_1291_field_0_3').value= removeCharSurname.replace(/s/g,'');


    /*var firstnameTrim =  document.getElementById('strCDA_1291_field_0_2').value.trim();
    var secondnameTrim = document.getElementById('strCDA_1291_field_0_3').value.trim();
    
    firstnameTrim = document.getElementById('strCDA_1291_field_0_2').value.trim();
    secondnameTrim = document.getElementById('strCDA_1291_field_0_3').value.trim();
    
    document.getElementById('strCDA_1291_field_0_3').value = secondnameTrim;*/
    var applicationExpiryDate = document.getElementById('strCDA_1291_field_0_35');
    var paperworkDueBackDate = document.getElementById('strCDA_1291_field_0_225');

    $JQ(document).ready(function () {
        HideShowTabs();
        taxiDispaly();

        trimApplicationID();
        DeclineEmail();
        //cleanFirstname();
        //cleanSurname();
        fn_FEXCO_GenerateRandomNumber();
        fn_FEXCO_SetApplicationIDValues();
        fn_FEXCO_SetToUppercase();
        CapTotalCosts();
        VehRegCheck();
        EvChargerAcceptOrReject();
        RECAcceptRaject();
        ApplicationsSupportingDocument();
        ElecTestRecordSheet();
        ElecCert3();
        TaxisDocumentPaymentRequest();
        ApplicationsDocumentPaymentRequest();
        CustomersName();
        fn_ModifyOutcomes();
        //document.getElementById('strContact_Outcome').setAttribute("onchange",'RejectionReasons();DeclineReasons()');
        CurrentMonth();
        MonthName();
        TodaysDate();
        
        //AgentOutcomesPhase1();
        trimIban();
        BicDigits();
        //PaymentCompleteStatus();
        
        hiddenGrantPayableField();
        fn_Tabs_strCDA_1291_field_0_125('tableid_0', 'strCDA_1291_field_0_0');

        modifyPaymentCompleteStatus();
        modifyOutcomes2();


        paperworkDueBackDate.value = applicationExpiryDate.value;

        //decode fields
        var titleName = document.getElementById('strCDA_1291_field_0_1');
        var firstname = document.getElementById('strCDA_1291_field_0_2');
        var surname = document.getElementById('strCDA_1291_field_0_3');
        var address1 = document.getElementById('strCDA_1291_field_0_4');
        var address2 = document.getElementById('strCDA_1291_field_0_5');
        var address3 = document.getElementById('strCDA_1291_field_0_6');
        var town = document.getElementById('strCDA_1291_field_0_7');
        var county = document.getElementById('strCDA_1291_field_0_7');
        var openingHeader = document.getElementById('strCDA_1291_field_0_52');


        function decodeElement(elementID) {
            elementID.value = decodeURI(elementID.value);
        }
        decodeElement(titleName);
        decodeElement(firstname);
        decodeElement(surname);
        decodeElement(address1);
        decodeElement(address2);
        decodeElement(address3);
        decodeElement(town);
        decodeElement(county);
        decodeElement(openingHeader);
        

    });

    $JQ("#strCDA_1291_field_0_225").datepicker({
        dateFormat: 'dd/mm/yy'

    });



function trimApplicationID(){
    document.getElementById('strCDA_1291_field_0_36').value = fn_String_ReplaceAllOccurrencesCustom(document.getElementById('strCDA_1291_field_0_36').value, ' ', '');
}



</script>
<!-- Trigger the modal with a button -->
<div id="previewhold"><button type="button" id='btnPreview' onclick='previewModal();' class="btn btn-info btn-lg" data-toggle="modal"
        data-target="#myModal">Click to Preview Email </button></div>
</div>

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">Ã</button>
                <h4 class="modal-title">The Email/Letter will consist of the following: </h4>
            </div>
            <div class="modal-body">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close Preview</button>
            </div>
        </div>

    </div>
</div>

<script>